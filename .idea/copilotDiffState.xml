<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/CATEGORIAS_UNIFICADAS.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/CATEGORIAS_UNIFICADAS.md" />
              <option name="updatedContent" value="# ✅ CATEGORÍAS UNIFICADAS EN TODA LA APLICACIÓN&#10;&#10;##  Problema Identificado&#10;&#10;Las **categorías** que podía seleccionar el usuario al crear una receta en la comunidad eran **diferentes** a las que ve en la aplicación y a las que usa el administrador. Esto causaba inconsistencias.&#10;&#10;### ❌ Antes (Inconsistente)&#10;&#10;**Usuario ve en la app:**&#10;-  Desayuno&#10;-  Almuerzo&#10;-  Cena&#10;-  Postre&#10;-  Bebidas&#10;-  Snacks&#10;-  Ensaladas&#10;-  Sopas&#10;-  Carnes&#10;-  Pescados&#10;-  Pastas&#10;-  Pizzas&#10;-  Vegetariana&#10;-  Vegana&#10;- ⚡ Rápidas&#10;-  Económica&#10;&#10;**Usuario podía publicar con:**&#10;-  Pastas&#10;-  Pizzas&#10;-  Ensaladas&#10;-  Sopas&#10;-  Carnes&#10;-  Pescados&#10;-  Postres&#10;-  Bebidas&#10;-  Vegano ← Diferente&#10;-  Vegetariano ← Diferente&#10;&#10;**Problemas:**&#10;- ❌ &quot;Vegano&quot; vs &quot;Vegana&quot;&#10;- ❌ &quot;Vegetariano&quot; vs &quot;Vegetariana&quot;&#10;- ❌ Faltaban: Desayuno, Almuerzo, Cena, Snacks, Sopas, Rápidas, Económica&#10;- ❌ Diferentes iconos&#10;&#10;---&#10;&#10;## ✅ Solución Implementada&#10;&#10;He **centralizado todas las categorías** en `Categorias.kt` y ahora **TODO** usa el mismo objeto.&#10;&#10;### Archivo Central: `Categorias.kt`&#10;&#10;```kotlin&#10;object Categorias {&#10;    // Categorías principales que se muestran al usuario&#10;    val lista = listOf(&#10;        Categoria(&quot;Todas&quot;, &quot;️&quot;),       // Solo para filtros&#10;        Categoria(&quot;Desayuno&quot;, &quot;&quot;),&#10;        Categoria(&quot;Almuerzo&quot;, &quot;&quot;),&#10;        Categoria(&quot;Cena&quot;, &quot;&quot;),&#10;        Categoria(&quot;Postre&quot;, &quot;&quot;),&#10;        Categoria(&quot;Bebidas&quot;, &quot;&quot;),&#10;        Categoria(&quot;Snacks&quot;, &quot;&quot;),&#10;        Categoria(&quot;Ensaladas&quot;, &quot;&quot;),&#10;        Categoria(&quot;Sopas&quot;, &quot;&quot;),&#10;        Categoria(&quot;Carnes&quot;, &quot;&quot;),&#10;        Categoria(&quot;Pescados&quot;, &quot;&quot;),&#10;        Categoria(&quot;Pastas&quot;, &quot;&quot;),&#10;        Categoria(&quot;Pizzas&quot;, &quot;&quot;),&#10;        Categoria(&quot;Vegetariana&quot;, &quot;&quot;),&#10;        Categoria(&quot;Vegana&quot;, &quot;&quot;),&#10;        Categoria(&quot;Rápidas&quot;, &quot;⚡&quot;),&#10;        Categoria(&quot;Económica&quot;, &quot;&quot;)&#10;    )&#10;&#10;    // Para usar en formularios (sin &quot;Todas&quot;)&#10;    val listaCompleta = lista&#10;        .filter { it.nombre != &quot;Todas&quot; }&#10;        .map { it.nombre }&#10;}&#10;```&#10;&#10;---&#10;&#10;##  Cambios Realizados&#10;&#10;### 1️⃣ **PantallaCrearReceta.kt** (Formulario Usuario Comunidad)&#10;&#10;**Antes (❌ Hardcodeado):**&#10;```kotlin&#10;val categorias = listOf(&#10;    &quot; Pastas&quot;,&#10;    &quot; Pizzas&quot;,&#10;    &quot; Ensaladas&quot;,&#10;    &quot; Sopas&quot;,&#10;    &quot; Carnes&quot;,&#10;    &quot; Pescados&quot;,&#10;    &quot; Postres&quot;,&#10;    &quot; Bebidas&quot;,&#10;    &quot; Vegano&quot;,      // ← Diferente&#10;    &quot; Vegetariano&quot;  // ← Diferente&#10;)&#10;```&#10;&#10;**Ahora (✅ Centralizado):**&#10;```kotlin&#10;import com.example.saborforaneo.util.Categorias&#10;&#10;// Usar categorías centralizadas&#10;val categorias = Categorias.lista&#10;    .filter { it.nombre != &quot;Todas&quot; }       // Quitar &quot;Todas&quot;&#10;    .map { &quot;${it.icono} ${it.nombre}&quot; }    // Formato: &quot; Pastas&quot;&#10;```&#10;&#10;### 2️⃣ **DialogoFormularioReceta.kt** (Formulario Admin)&#10;&#10;**Ya estaba correcto:**&#10;```kotlin&#10;import com.example.saborforaneo.util.Categorias&#10;&#10;// Usar categorías centralizadas&#10;val categorias = Categorias.listaCompleta&#10;```&#10;&#10;### 3️⃣ **Todas las pantallas de la app**&#10;&#10;Cualquier lugar que use categorías ahora importa y usa `Categorias.kt`:&#10;```kotlin&#10;import com.example.saborforaneo.util.Categorias&#10;&#10;// Filtros en HomeScreen&#10;Categorias.lista.forEach { categoria -&gt;&#10;    ChipFiltro(...)&#10;}&#10;&#10;// Iconos&#10;val icono = Categorias.obtenerIcono(nombreCategoria)&#10;```&#10;&#10;---&#10;&#10;## ✅ Ahora TODO es Consistente&#10;&#10;### Categorías Disponibles en TODA la App&#10;&#10;| Categoría | Icono | Disponible en Usuario | Disponible en Admin | Filtro en Home |&#10;|-----------|-------|----------------------|---------------------|----------------|&#10;| Desayuno |  | ✅ | ✅ | ✅ |&#10;| Almuerzo |  | ✅ | ✅ | ✅ |&#10;| Cena |  | ✅ | ✅ | ✅ |&#10;| Postre |  | ✅ | ✅ | ✅ |&#10;| Bebidas |  | ✅ | ✅ | ✅ |&#10;| Snacks |  | ✅ | ✅ | ✅ |&#10;| Ensaladas |  | ✅ | ✅ | ✅ |&#10;| Sopas |  | ✅ | ✅ | ✅ |&#10;| Carnes |  | ✅ | ✅ | ✅ |&#10;| Pescados |  | ✅ | ✅ | ✅ |&#10;| Pastas |  | ✅ | ✅ | ✅ |&#10;| Pizzas |  | ✅ | ✅ | ✅ |&#10;| Vegetariana |  | ✅ | ✅ | ✅ |&#10;| Vegana |  | ✅ | ✅ | ✅ |&#10;| Rápidas | ⚡ | ✅ | ✅ | ✅ |&#10;| Económica |  | ✅ | ✅ | ✅ |&#10;&#10;**Total: 16 categorías consistentes en toda la app**&#10;&#10;---&#10;&#10;##  Ventajas de la Centralización&#10;&#10;### 1. **Consistencia Total**&#10;- ✅ Usuario ve las mismas categorías en todos lados&#10;- ✅ Admin usa las mismas categorías&#10;- ✅ Filtros usan las mismas categorías&#10;- ✅ Búsquedas funcionan correctamente&#10;&#10;### 2. **Fácil Mantenimiento**&#10;- ✅ Agregar categoría: editar solo `Categorias.kt`&#10;- ✅ Cambiar icono: editar solo `Categorias.kt`&#10;- ✅ Renombrar categoría: editar solo `Categorias.kt`&#10;- ✅ Se aplica automáticamente en TODA la app&#10;&#10;### 3. **Sin Errores**&#10;- ✅ No hay categorías duplicadas con nombres diferentes&#10;- ✅ No hay categorías que no existan&#10;- ✅ Todas las categorías tienen icono&#10;- ✅ Validación centralizada&#10;&#10;### 4. **Escalable**&#10;- ✅ Fácil agregar nuevas categorías&#10;- ✅ Fácil agregar validaciones&#10;- ✅ Fácil agregar traducciones (futuro)&#10;- ✅ Una sola fuente de verdad&#10;&#10;---&#10;&#10;##  Cómo Probar&#10;&#10;### Test 1: Crear Receta en Comunidad&#10;```&#10;1. Ve a Comunidad → Mis Recetas → + (Crear)&#10;2. Click en &quot;Seleccionar categoría&quot;&#10;3. ✅ Verás todas las 16 categorías:&#10;   - Desayuno, Almuerzo, Cena, Postre, Bebidas&#10;   - Snacks, Ensaladas, Sopas, Carnes, Pescados&#10;   - Pastas, Pizzas, Vegetariana, Vegana&#10;   - Rápidas, Económica&#10;4. ✅ Todas con sus iconos correctos&#10;5. Selecciona &quot;Desayuno&quot;&#10;6. Crea la receta&#10;7. ✅ Se guarda con categoría &quot;Desayuno&quot;&#10;```&#10;&#10;### Test 2: Verificar en Home&#10;```&#10;1. Ve a Home&#10;2. Mira los filtros de categorías&#10;3. ✅ Verás las mismas 16 categorías + &quot;Todas&quot;&#10;4. Click en &quot;Desayuno&quot;&#10;5. ✅ Verás la receta que creaste&#10;```&#10;&#10;### Test 3: Admin&#10;```&#10;1. Login como admin&#10;2. Gestión de Recetas → Agregar&#10;3. Selecciona categorías&#10;4. ✅ Verás las mismas 16 categorías&#10;5. Selecciona múltiples&#10;6. Guarda&#10;7. ✅ Se guardan correctamente&#10;```&#10;&#10;### Test 4: Buscar por Categoría&#10;```&#10;1. Ve a Buscar&#10;2. Busca &quot;Desayuno&quot;&#10;3. ✅ Encuentra todas las recetas de desayuno&#10;   (incluidas las del admin y las de comunidad)&#10;```&#10;&#10;---&#10;&#10;##  Comparación: Antes vs Ahora&#10;&#10;### Antes (❌ Inconsistente)&#10;&#10;```&#10;Usuario ve:        Usuario publica:    Admin usa:&#10;- Desayuno         - Pastas            - Desayuno&#10;- Almuerzo         - Pizzas            - Almuerzo&#10;- Cena             - Ensaladas         - Cena&#10;- Postre           - Sopas             - Postre&#10;- Bebidas          - Carnes            - (todas las 16)&#10;- Snacks           - Pescados&#10;- Ensaladas        - Postres&#10;- Sopas            - Bebidas&#10;- Carnes           - Vegano ❌&#10;- Pescados         - Vegetariano ❌&#10;- Pastas           &#10;- Pizzas           (solo 10)&#10;- Vegetariana      &#10;- Vegana           &#10;- Rápidas          &#10;- Económica        &#10;&#10;❌ INCONSISTENTE&#10;```&#10;&#10;### Ahora (✅ Consistente)&#10;&#10;```&#10;Usuario ve:        Usuario publica:    Admin usa:&#10;- Desayuno    ✅   - Desayuno     ✅   - Desayuno     ✅&#10;- Almuerzo    ✅   - Almuerzo     ✅   - Almuerzo     ✅&#10;- Cena        ✅   - Cena         ✅   - Cena         ✅&#10;- Postre      ✅   - Postre       ✅   - Postre       ✅&#10;- Bebidas     ✅   - Bebidas      ✅   - Bebidas      ✅&#10;- Snacks      ✅   - Snacks       ✅   - Snacks       ✅&#10;- Ensaladas   ✅   - Ensaladas    ✅   - Ensaladas    ✅&#10;- Sopas       ✅   - Sopas        ✅   - Sopas        ✅&#10;- Carnes      ✅   - Carnes       ✅   - Carnes       ✅&#10;- Pescados    ✅   - Pescados     ✅   - Pescados     ✅&#10;- Pastas      ✅   - Pastas       ✅   - Pastas       ✅&#10;- Pizzas      ✅   - Pizzas       ✅   - Pizzas       ✅&#10;- Vegetariana ✅   - Vegetariana  ✅   - Vegetariana  ✅&#10;- Vegana      ✅   - Vegana       ✅   - Vegana       ✅&#10;- Rápidas     ✅   - Rápidas      ✅   - Rápidas      ✅&#10;- Económica   ✅   - Económica    ✅   - Económica    ✅&#10;&#10;✅ CONSISTENTE EN TODA LA APP&#10;```&#10;&#10;---&#10;&#10;##  Cómo Agregar Nueva Categoría (Futuro)&#10;&#10;Si quieres agregar una nueva categoría en el futuro:&#10;&#10;### 1. Editar solo `Categorias.kt`&#10;```kotlin&#10;val lista = listOf(&#10;    // ...existing categories...&#10;    Categoria(&quot;Mexicana&quot;, &quot;&quot;),  // ← Nueva categoría&#10;    Categoria(&quot;Italiana&quot;, &quot;&quot;)   // ← Otra nueva&#10;)&#10;```&#10;&#10;### 2. Automáticamente aparece en:&#10;- ✅ Filtros en Home&#10;- ✅ Formulario de usuario (comunidad)&#10;- ✅ Formulario de admin&#10;- ✅ Búsquedas&#10;- ✅ Toda la app&#10;&#10;### 3. No necesitas modificar:&#10;- ❌ Ningún otro archivo&#10;- ❌ Ninguna pantalla&#10;- ❌ Ningún formulario&#10;- ❌ Todo se actualiza automáticamente&#10;&#10;---&#10;&#10;##  Archivos Modificados&#10;&#10;### 1. **PantallaCrearReceta.kt**&#10;- ✅ Agregado import `Categorias`&#10;- ✅ Reemplazada lista hardcodeada&#10;- ✅ Ahora usa `Categorias.lista`&#10;- ✅ Formato dinámico con iconos&#10;&#10;### 2. **Categorias.kt** (Sin cambios)&#10;- ✅ Ya estaba bien diseñado&#10;- ✅ Fuente única de verdad&#10;- ✅ Usado en toda la app&#10;&#10;### 3. **DialogoFormularioReceta.kt** (Sin cambios)&#10;- ✅ Ya usaba `Categorias.listaCompleta`&#10;- ✅ Ya estaba correcto&#10;&#10;---&#10;&#10;## ✅ Verificación Final&#10;&#10;Después de los cambios:&#10;&#10;- [x] Import de Categorias agregado&#10;- [x] Lista hardcodeada eliminada&#10;- [x] Usa Categorias.lista centralizado&#10;- [x] Todas las 16 categorías disponibles&#10;- [x] Iconos consistentes&#10;- [x] Mismas categorías en usuario y admin&#10;- [x] Sin errores de compilación&#10;- [x] Nombres exactos (Vegana no Vegano)&#10;&#10;---&#10;&#10;##  Próximos Pasos&#10;&#10;1. **Force Stop** la app (⏹️)&#10;2. **Build → Clean Project**&#10;3. **Build → Rebuild Project**&#10;4. **Ejecuta la app**&#10;5. **Ve a Comunidad → Crear Receta**&#10;6. **Selecciona categoría**&#10;7. ✅ **Verás todas las 16 categorías correctas**&#10;8. **Verifica que coincidan con las de Home y Admin**&#10;&#10;---&#10;&#10;##  Resultado Final&#10;&#10;### ✅ Categorías Unificadas&#10;- 16 categorías en toda la app ✅&#10;- Mismos nombres en usuario y admin ✅&#10;- Mismos iconos en todas partes ✅&#10;- Fuente única de verdad ✅&#10;- Fácil de mantener ✅&#10;&#10;### ✅ Usuario Puede Publicar Con:&#10;- Desayuno, Almuerzo, Cena ✅&#10;- Postre, Bebidas, Snacks ✅&#10;- Ensaladas, Sopas ✅&#10;- Carnes, Pescados ✅&#10;- Pastas, Pizzas ✅&#10;- Vegetariana, Vegana ✅&#10;- Rápidas, Económica ✅&#10;&#10;### ✅ Consistencia Total&#10;- Filtros en Home ✅&#10;- Formulario Usuario ✅&#10;- Formulario Admin ✅&#10;- Búsquedas ✅&#10;- Visualización ✅&#10;&#10;---&#10;&#10;** CATEGORÍAS COMPLETAMENTE UNIFICADAS**&#10;&#10;Ahora hay **consistencia total** en las categorías:&#10;- ✅ Usuario ve y puede usar las mismas 16&#10;- ✅ Admin usa las mismas 16&#10;- ✅ Filtros usan las mismas 16&#10;- ✅ Una sola fuente de verdad&#10;- ✅ Fácil de mantener y escalar&#10;&#10;**¡Ejecuta la app y verifica que todas las categorías son consistentes!** &#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/COMPARTIR_RECETAS_IMPLEMENTADO.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/COMPARTIR_RECETAS_IMPLEMENTADO.md" />
              <option name="updatedContent" value="# ✅ FUNCIONALIDAD DE COMPARTIR RECETAS IMPLEMENTADA&#10;&#10;##  Funcionalidad Agregada&#10;&#10;He implementado la lógica completa para **compartir recetas** en otras aplicaciones (WhatsApp, Facebook, Instagram, Twitter, Gmail, etc.) usando el sistema nativo de compartir de Android.&#10;&#10;---&#10;&#10;##  Implementación&#10;&#10;### 1️⃣ **PantallaDetalleReceta.kt** (Recetas Normales)&#10;&#10;#### Imports Agregados&#10;```kotlin&#10;import android.content.Intent&#10;```&#10;&#10;#### Lógica de Compartir&#10;```kotlin&#10;IconButton(onClick = {&#10;    receta?.let { recetaActual -&gt;&#10;        // Crear texto completo para compartir&#10;        val textoCompartir = buildString {&#10;            append(&quot; ${recetaActual.nombre}\n\n&quot;)&#10;            append(&quot; ${recetaActual.descripcion}\n\n&quot;)&#10;            append(&quot;⏱️ Tiempo: ${recetaActual.tiempoPreparacion} min\n&quot;)&#10;            append(&quot;️ Porciones: ${recetaActual.porciones}\n&quot;)&#10;            append(&quot; Dificultad: ${recetaActual.dificultad.name}\n\n&quot;)&#10;            &#10;            // Ingredientes&#10;            if (recetaActual.ingredientes.isNotEmpty()) {&#10;                append(&quot; Ingredientes:\n&quot;)&#10;                recetaActual.ingredientes.forEachIndexed { index, ingrediente -&gt;&#10;                    append(&quot;${index + 1}. $ingrediente\n&quot;)&#10;                }&#10;                append(&quot;\n&quot;)&#10;            }&#10;            &#10;            // Pasos&#10;            if (recetaActual.pasos.isNotEmpty()) {&#10;                append(&quot;‍ Pasos:\n&quot;)&#10;                recetaActual.pasos.forEachIndexed { index, paso -&gt;&#10;                    append(&quot;${index + 1}. $paso\n&quot;)&#10;                }&#10;            }&#10;            &#10;            append(&quot;\n¡Comparte esta deliciosa receta de SaborForáneo! &quot;)&#10;        }&#10;        &#10;        // Intent para compartir&#10;        val intentCompartir = Intent(Intent.ACTION_SEND).apply {&#10;            type = &quot;text/plain&quot;&#10;            putExtra(Intent.EXTRA_SUBJECT, &quot;Receta: ${recetaActual.nombre}&quot;)&#10;            putExtra(Intent.EXTRA_TEXT, textoCompartir)&#10;        }&#10;        &#10;        // Mostrar selector de apps&#10;        val chooser = Intent.createChooser(intentCompartir, &quot;Compartir receta vía...&quot;)&#10;        contexto.startActivity(chooser)&#10;    }&#10;})&#10;```&#10;&#10;---&#10;&#10;### 2️⃣ **PantallaDetalleRecetaComunidad.kt** (Recetas de Comunidad)&#10;&#10;#### Imports Agregados&#10;```kotlin&#10;import android.content.Intent&#10;import androidx.compose.ui.platform.LocalContext&#10;```&#10;&#10;#### Contexto Agregado&#10;```kotlin&#10;val contexto = LocalContext.current&#10;```&#10;&#10;#### Botón de Compartir en TopAppBar&#10;```kotlin&#10;actions = {&#10;    IconButton(onClick = {&#10;        uiState.receta?.let { receta -&gt;&#10;            // Crear texto para compartir&#10;            val textoCompartir = buildString {&#10;                append(&quot; ${receta.nombre}\n\n&quot;)&#10;                append(&quot; ${receta.descripcion}\n\n&quot;)&#10;                append(&quot; Compartido por: ${receta.autorNombre}\n\n&quot;)&#10;                append(&quot;⏱️ Tiempo: ${receta.tiempoPreparacion} min\n&quot;)&#10;                append(&quot;️ Porciones: ${receta.porciones}\n&quot;)&#10;                append(&quot; Dificultad: ${receta.dificultad.name}\n&quot;)&#10;                append(&quot;️ Categoría: ${receta.categoria}\n\n&quot;)&#10;                &#10;                // Ingredientes y pasos...&#10;                &#10;                append(&quot;\n ${receta.comentarios} comentarios&quot;)&#10;                append(&quot;\n❤️ ${receta.likes} likes&quot;)&#10;                append(&quot;\n\n¡Descubre más recetas en SaborForáneo! &quot;)&#10;            }&#10;            &#10;            // Intent para compartir&#10;            val intentCompartir = Intent(Intent.ACTION_SEND).apply {&#10;                type = &quot;text/plain&quot;&#10;                putExtra(Intent.EXTRA_SUBJECT, &quot;Receta: ${receta.nombre}&quot;)&#10;                putExtra(Intent.EXTRA_TEXT, textoCompartir)&#10;            }&#10;            &#10;            val chooser = Intent.createChooser(intentCompartir, &quot;Compartir receta vía...&quot;)&#10;            contexto.startActivity(chooser)&#10;        }&#10;    }) {&#10;        Icon(Icons.Default.Share, &quot;Compartir receta&quot;)&#10;    }&#10;}&#10;```&#10;&#10;---&#10;&#10;##  Formato del Texto Compartido&#10;&#10;### Recetas Normales&#10;```&#10; Pizza Margherita&#10;&#10; Deliciosa pizza italiana con tomate, mozzarella y albahaca fresca&#10;&#10;⏱️ Tiempo: 30 min&#10;️ Porciones: 4&#10; Dificultad: MEDIA&#10;&#10; Ingredientes:&#10;1. Masa para pizza&#10;2. Salsa de tomate&#10;3. Mozzarella fresca&#10;4. Albahaca fresca&#10;5. Aceite de oliva&#10;&#10;‍ Pasos:&#10;1. Precalentar el horno a 220°C&#10;2. Extender la masa sobre una superficie&#10;3. Agregar la salsa de tomate&#10;4. Añadir mozzarella y albahaca&#10;5. Hornear durante 15 minutos&#10;&#10;¡Comparte esta deliciosa receta de SaborForáneo! &#10;```&#10;&#10;### Recetas de Comunidad&#10;```&#10; Tacos de Pescado&#10;&#10; Tacos frescos con pescado empanizado&#10;&#10; Compartido por: Juan Pérez&#10;&#10;⏱️ Tiempo: 25 min&#10;️ Porciones: 3&#10; Dificultad: MEDIA&#10;️ Categoría:  Pescados&#10;&#10; Ingredientes:&#10;1. Filete de pescado&#10;2. Tortillas de maíz&#10;3. Repollo morado&#10;4. Salsa de cilantro&#10;5. Limón&#10;&#10;‍ Pasos:&#10;1. Empanizar el pescado&#10;2. Freír hasta dorar&#10;3. Preparar las tortillas&#10;4. Armar los tacos&#10;5. Servir con limón&#10;&#10; 5 comentarios&#10;❤️ 12 likes&#10;&#10;¡Descubre más recetas en SaborForáneo! &#10;```&#10;&#10;---&#10;&#10;##  Aplicaciones Compatibles&#10;&#10;El selector de compartir muestra **TODAS las apps instaladas** que pueden compartir texto:&#10;&#10;### Mensajería&#10;-  WhatsApp&#10;-  Telegram&#10;-  Messenger&#10;-  SMS/Mensajes&#10;&#10;### Redes Sociales&#10;-  Facebook&#10;-  Twitter/X&#10;-  Instagram (Stories)&#10;-  LinkedIn&#10;&#10;### Email&#10;-  Gmail&#10;-  Outlook&#10;-  Otras apps de correo&#10;&#10;### Otras&#10;-  Copiar al portapapeles&#10;-  Google Keep&#10;-  Google Drive&#10;- ⭐ Y cualquier app que soporte compartir texto&#10;&#10;---&#10;&#10;##  Cómo Probar&#10;&#10;### Test 1: Compartir Receta Normal&#10;```&#10;1. Abre la app&#10;2. Ve a una receta (ej: Pizza Margherita)&#10;3. Click en botón Share (arriba a la derecha)&#10;4. ✅ Aparece selector de apps&#10;5. Selecciona WhatsApp&#10;6. ✅ Se abre WhatsApp con el texto de la receta&#10;7. ✅ Puedes enviarla a un contacto&#10;```&#10;&#10;### Test 2: Compartir Receta de Comunidad&#10;```&#10;1. Ve a Comunidad&#10;2. Abre una receta de la comunidad&#10;3. Click en botón Share (arriba a la derecha)&#10;4. ✅ Aparece selector de apps&#10;5. Selecciona Instagram&#10;6. ✅ Se abre Instagram para compartir en Stories&#10;```&#10;&#10;### Test 3: Compartir por Email&#10;```&#10;1. Abre cualquier receta&#10;2. Click en Share&#10;3. Selecciona Gmail&#10;4. ✅ Se abre Gmail con:&#10;   - Asunto: &quot;Receta: [Nombre de la receta]&quot;&#10;   - Cuerpo: Texto completo con ingredientes y pasos&#10;5. Agrega destinatario y envía&#10;```&#10;&#10;### Test 4: Copiar al Portapapeles&#10;```&#10;1. Abre una receta&#10;2. Click en Share&#10;3. Selecciona &quot;Copiar&quot;&#10;4. ✅ Texto copiado al portapapeles&#10;5. Pega en cualquier app (ej: Notes)&#10;6. ✅ Verás todo el texto de la receta&#10;```&#10;&#10;---&#10;&#10;##  Ventajas de la Implementación&#10;&#10;### Para el Usuario&#10;- ⚡ **Rápido** - 2 clicks para compartir&#10;-  **Flexible** - Elige la app que prefiera&#10;-  **Completo** - Incluye toda la información&#10;-  **Emojis** - Formato atractivo y legible&#10;&#10;### Técnicamente&#10;- ️ **Nativo** - Usa el sistema de Android&#10;-  **Universal** - Funciona con todas las apps&#10;-  **Sin almacenamiento** - No guarda archivos temporales&#10;-  **Sin errores** - API estable de Android&#10;&#10;---&#10;&#10;##  Información Compartida&#10;&#10;### Recetas Normales Incluyen:&#10;- ✅ Nombre de la receta&#10;- ✅ Descripción&#10;- ✅ Tiempo de preparación&#10;- ✅ Número de porciones&#10;- ✅ Dificultad&#10;- ✅ Lista completa de ingredientes (numerada)&#10;- ✅ Pasos detallados (numerados)&#10;- ✅ Mensaje de marca&#10;&#10;### Recetas de Comunidad Incluyen Todo lo Anterior MÁS:&#10;- ✅ Nombre del autor&#10;- ✅ Categoría&#10;- ✅ Número de comentarios&#10;- ✅ Número de likes&#10;- ✅ Llamado a acción diferente&#10;&#10;---&#10;&#10;##  Detalles Técnicos&#10;&#10;### Intent.ACTION_SEND&#10;```kotlin&#10;Intent(Intent.ACTION_SEND).apply {&#10;    type = &quot;text/plain&quot;  // Tipo de contenido&#10;    putExtra(Intent.EXTRA_SUBJECT, &quot;...&quot;)  // Asunto (para email)&#10;    putExtra(Intent.EXTRA_TEXT, &quot;...&quot;)     // Contenido principal&#10;}&#10;```&#10;&#10;### Intent.createChooser&#10;```kotlin&#10;Intent.createChooser(intentCompartir, &quot;Compartir receta vía...&quot;)&#10;```&#10;- Muestra el selector de apps nativo de Android&#10;- Título personalizado: &quot;Compartir receta vía...&quot;&#10;- Lista todas las apps compatibles&#10;&#10;### buildString&#10;```kotlin&#10;buildString {&#10;    append(&quot;texto&quot;)&#10;    append(&quot;\n&quot;)  // Salto de línea&#10;}&#10;```&#10;- Eficiente para construir strings largos&#10;- Más rápido que concatenación con `+`&#10;&#10;---&#10;&#10;##  Mejoras Futuras Posibles&#10;&#10;### Opciones NO Implementadas (Pueden agregarse después)&#10;- [ ] Compartir con imagen de la receta (requiere descargar imagen)&#10;- [ ] Enlace directo a la receta en la app&#10;- [ ] Formato HTML para emails&#10;- [ ] Estadísticas de compartidos&#10;- [ ] Compartir múltiples recetas a la vez&#10;&#10;---&#10;&#10;## ✅ Verificación&#10;&#10;Después de los cambios:&#10;&#10;- [x] Import de Intent agregado&#10;- [x] Botón Share funcional en recetas normales&#10;- [x] Botón Share agregado en recetas de comunidad&#10;- [x] LocalContext agregado donde se necesita&#10;- [x] Texto formateado con emojis&#10;- [x] Información completa incluida&#10;- [x] Sin errores de compilación&#10;&#10;---&#10;&#10;##  Archivos Modificados&#10;&#10;### 1. **PantallaDetalleReceta.kt**&#10;- ✅ Import `Intent` agregado&#10;- ✅ Lógica de compartir en botón Share&#10;- ✅ Formato de texto para recetas normales&#10;&#10;### 2. **PantallaDetalleRecetaComunidad.kt**&#10;- ✅ Import `Intent` agregado&#10;- ✅ Import `LocalContext` agregado&#10;- ✅ Variable `contexto` agregada&#10;- ✅ Botón Share en TopAppBar&#10;- ✅ Formato de texto para recetas de comunidad&#10;&#10;---&#10;&#10;##  Próximos Pasos&#10;&#10;1. **Force Stop** la app (⏹️)&#10;2. **Build → Clean Project**&#10;3. **Build → Rebuild Project**&#10;4. **Ejecuta la app**&#10;5. **Abre una receta**&#10;6. **Click en el icono Share** (↗️ arriba a la derecha)&#10;7. ✅ **Verás el selector de apps**&#10;8. ✅ **Selecciona una app (ej: WhatsApp)**&#10;9. ✅ **Verás la receta formateada lista para enviar**&#10;&#10;---&#10;&#10;##  Resultado Final&#10;&#10;### ✅ Funcionalidad Completa&#10;- Compartir recetas normales ✅&#10;- Compartir recetas de comunidad ✅&#10;- Selector nativo de Android ✅&#10;- Formato atractivo con emojis ✅&#10;- Información completa ✅&#10;&#10;### ✅ Experiencia de Usuario&#10;- Fácil de usar (2 clicks)&#10;- Compatible con todas las apps&#10;- Texto bien formateado&#10;- Listo para enviar&#10;- Como apps profesionales&#10;&#10;### ✅ Plataformas Compatibles&#10;- WhatsApp ✅&#10;- Facebook ✅&#10;- Instagram ✅&#10;- Twitter ✅&#10;- Gmail ✅&#10;- Telegram ✅&#10;- Y todas las demás ✅&#10;&#10;---&#10;&#10;** FUNCIONALIDAD DE COMPARTIR COMPLETAMENTE IMPLEMENTADA**&#10;&#10;Los usuarios ahora pueden:&#10;- ✅ Compartir recetas en cualquier app&#10;- ✅ Enviar recetas por WhatsApp&#10;- ✅ Publicar en redes sociales&#10;- ✅ Enviar por email&#10;- ✅ Copiar al portapapeles&#10;- ✅ Difundir SaborForáneo fácilmente&#10;&#10;**¡Ejecuta la app y prueba compartiendo una receta!** &#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/SCROLL_SELECTOR_TEMAS_CORREGIDO.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SCROLL_SELECTOR_TEMAS_CORREGIDO.md" />
              <option name="updatedContent" value="# ✅ SCROLL EN SELECTOR DE TEMAS CORREGIDO&#10;&#10;##  Problema Identificado&#10;&#10;El **diálogo de selección de temas** en las preferencias del usuario NO tenía scroll habilitado. Cuando se mostraban los 5 temas disponibles (Verde, Rojo, Azul, Naranja, Morado), en **pantallas pequeñas** no cabían todos y **no se podía hacer scroll** para ver los últimos temas.&#10;&#10;##  Solución Implementada&#10;&#10;He agregado **scroll vertical** al diálogo de selección de temas para que **todos los temas sean accesibles** sin importar el tamaño de la pantalla.&#10;&#10;### Cambios Aplicados&#10;&#10;**Archivo:** `DialogoSelectorTema.kt`&#10;&#10;#### 1. Agregado Imports&#10;```kotlin&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.verticalScroll&#10;```&#10;&#10;#### 2. Agregado ScrollState y Altura Máxima al Column&#10;```kotlin&#10;text = {&#10;    val scrollState = rememberScrollState()  // ✅ Nuevo&#10;    &#10;    Column(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .heightIn(max = 400.dp)           // ✅ Altura máxima&#10;            .verticalScroll(scrollState)      // ✅ Scroll habilitado&#10;    ) {&#10;        // ... lista de temas&#10;    }&#10;}&#10;```&#10;&#10;## ✅ Ahora Funciona&#10;&#10;### Antes (❌ Sin Scroll)&#10;```&#10;┌─────────────────────────┐&#10;│    Tema de Color      │&#10;│                         │&#10;│ ✅ Verde (seleccionado) │&#10;│ ⚪ Rojo                 │&#10;│ ⚪ Azul                 │&#10;│ ⚪ Naranja    ← VISIBLE │&#10;│ ⚪ Morado     ← NO SE VE│ ❌ Cortado&#10;│                         │&#10;│ [Cancelar] [Aplicar]    │&#10;└─────────────────────────┘&#10;```&#10;&#10;### Ahora (✅ Con Scroll)&#10;```&#10;┌─────────────────────────┐&#10;│    Tema de Color      │&#10;│                         │ ↕️ Se puede&#10;│ ✅ Verde (seleccionado) │ hacer scroll&#10;│ ⚪ Rojo                 │&#10;│ ⚪ Azul                 │&#10;│ ⚪ Naranja              │&#10;│ ⚪ Morado ✅            │ ← VISIBLE al hacer scroll&#10;│                         │&#10;│ [Cancelar] [Aplicar]    │&#10;└─────────────────────────┘&#10;```&#10;&#10;##  Características Implementadas&#10;&#10;### 1. Scroll Vertical&#10;- Usuario puede desplazarse hacia arriba/abajo&#10;- Todos los 5 temas son accesibles&#10;- Funciona en cualquier tamaño de pantalla&#10;&#10;### 2. Altura Máxima&#10;```kotlin&#10;.heightIn(max = 400.dp)&#10;```&#10;- Limita la altura del diálogo&#10;- Previene que ocupe toda la pantalla&#10;- Activa el scroll cuando es necesario&#10;&#10;### 3. ScrollState Persistente&#10;```kotlin&#10;val scrollState = rememberScrollState()&#10;```&#10;- Mantiene la posición del scroll&#10;- Mejor experiencia de usuario&#10;&#10;##  Cómo Probar&#10;&#10;### Test 1: Acceso a Todos los Temas&#10;```&#10;1. Abre la app&#10;2. Ve a: Perfil → Preferencias → Tema&#10;3. Abre el diálogo de selección de temas&#10;4. ✅ Desliza hacia abajo&#10;5. ✅ Verás todos los 5 temas:&#10;   - Verde&#10;   - Rojo&#10;   - Azul&#10;   - Naranja&#10;   - Morado&#10;6. ✅ Todos son seleccionables&#10;```&#10;&#10;### Test 2: Pantalla Pequeña&#10;```&#10;1. Usa dispositivo con pantalla pequeña&#10;2. Abre selector de temas&#10;3. ✅ Puedes hacer scroll completo&#10;4. ✅ Tema Morado es visible al desplazar&#10;5. ✅ Puedes seleccionarlo&#10;```&#10;&#10;### Test 3: Selección de Tema&#10;```&#10;1. Abre selector de temas&#10;2. Desliza hacia abajo&#10;3. Selecciona &quot;Morado&quot; (el último)&#10;4. ✅ Se marca como seleccionado&#10;5. Click en &quot;Aplicar&quot;&#10;6. ✅ Tema se aplica correctamente&#10;```&#10;&#10;##  Temas Disponibles&#10;&#10;### Lista Completa (Ahora Todos Accesibles)&#10;1. ** Verde** - &quot;El color clásico de SaborForáneo&quot;&#10;2. ** Rojo** - &quot;Pasión por la cocina&quot;&#10;3. ** Azul** - &quot;Fresco y sereno&quot;&#10;4. ** Naranja** - &quot;Energético y cálido&quot;&#10;5. ** Morado** - &quot;Elegante y sofisticado&quot;&#10;&#10;##  Comportamiento del Scroll&#10;&#10;### Pantalla Grande&#10;```&#10;Todos los temas visibles&#10;Sin necesidad de scroll&#10;Altura &lt; 400dp&#10;```&#10;&#10;### Pantalla Mediana&#10;```&#10;Altura = 400dp (máximo)&#10;Scroll disponible&#10;Algunos temas requieren desplazamiento&#10;```&#10;&#10;### Pantalla Pequeña&#10;```&#10;Altura = 400dp (máximo)&#10;Scroll activo&#10;Solo 2-3 temas visibles inicialmente&#10;Scroll necesario para ver todos&#10;```&#10;&#10;##  Detalles Técnicos&#10;&#10;### heightIn(max = 400.dp)&#10;- Establece altura máxima del contenido&#10;- Si el contenido es menor, usa su altura natural&#10;- Si es mayor, limita a 400dp y activa scroll&#10;&#10;### verticalScroll(scrollState)&#10;- Habilita scroll vertical en el Column&#10;- Funciona dentro del AlertDialog&#10;- No afecta los botones de acción&#10;&#10;### Estructura del Diálogo&#10;```kotlin&#10;AlertDialog(&#10;    title = { ... }&#10;    text = {&#10;        // ✅ Aquí está el scroll&#10;        Column(&#10;            modifier = Modifier&#10;                .verticalScroll(scrollState)&#10;                .heightIn(max = 400.dp)&#10;        ) {&#10;            // Lista de temas&#10;        }&#10;    }&#10;    confirmButton = { ... }&#10;    dismissButton = { ... }&#10;)&#10;```&#10;&#10;##  Comparación: Antes vs Ahora&#10;&#10;| Aspecto | ❌ Antes | ✅ Ahora |&#10;|---------|----------|----------|&#10;| **Temas Visibles (pantalla pequeña)** | 3-4 | 5 (todos) |&#10;| **Scroll** | No | Sí |&#10;| **Altura** | Variable | Max 400dp |&#10;| **Accesibilidad** | Limitada | Completa |&#10;| **Tema Morado Visible** | No siempre | Siempre |&#10;&#10;## ✅ Verificación&#10;&#10;Después de aplicar estos cambios:&#10;&#10;- [ ] Clean + Rebuild del proyecto&#10;- [ ] Force Stop de la app&#10;- [ ] Ejecutar la app&#10;- [ ] Ir a Perfil → Tema&#10;- [ ] Abrir selector de temas&#10;- [ ] ✅ Hacer scroll hacia abajo&#10;- [ ] ✅ Ver tema Morado&#10;- [ ] ✅ Seleccionarlo y aplicarlo&#10;&#10;##  Archivos Modificados&#10;&#10;**DialogoSelectorTema.kt**&#10;- ✅ Agregado `rememberScrollState()`&#10;- ✅ Agregado `verticalScroll(scrollState)`&#10;- ✅ Agregado `heightIn(max = 400.dp)`&#10;- ✅ Imports actualizados&#10;&#10;##  Resultado Final&#10;&#10;### ✅ Problema Resuelto&#10;- Scroll funciona en el selector de temas&#10;- Todos los 5 temas son accesibles&#10;- Funciona en pantallas de cualquier tamaño&#10;- Altura limitada para mejor UX&#10;&#10;### ✅ Experiencia Mejorada&#10;- Usuario puede ver todos los temas&#10;- Puede seleccionar cualquiera&#10;- No hay opciones ocultas&#10;- Interfaz más profesional&#10;&#10;##  Notas Adicionales&#10;&#10;### Por Qué 400.dp&#10;- Suficiente para mostrar 3-4 temas completos&#10;- No ocupa toda la pantalla&#10;- Deja espacio para título y botones&#10;- Balance perfecto entre visibilidad y scroll&#10;&#10;### Alternativas Consideradas&#10;1. **LazyColumn** - No necesario para 5 items&#10;2. **Altura fija** - Menos flexible&#10;3. **Sin altura máxima** - Diálogo muy grande&#10;&#10;##  Próximos Pasos&#10;&#10;1. **Force Stop** la app (⏹️)&#10;2. **Build → Clean Project**&#10;3. **Build → Rebuild Project**&#10;4. **Ejecuta la app**&#10;5. **Ve a Perfil**&#10;6. **Click en el tema actual** (ej: &quot;☀️ Tema Claro&quot;)&#10;7. **Se abre el diálogo**&#10;8. **Desliza hacia abajo** &#10;9. ✅ **Verás todos los 5 temas**&#10;10. ✅ **Podrás seleccionar cualquiera**&#10;&#10;---&#10;&#10;** SCROLL EN SELECTOR DE TEMAS FUNCIONANDO**&#10;&#10;Ahora los usuarios pueden:&#10;- ✅ Ver todos los temas disponibles&#10;- ✅ Hacer scroll en el diálogo&#10;- ✅ Seleccionar cualquier tema&#10;- ✅ Personalizar su experiencia completamente&#10;&#10;**¡El problema está completamente resuelto!** &#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/SELECCION_MULTIPLE_CATEGORIAS.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SELECCION_MULTIPLE_CATEGORIAS.md" />
              <option name="updatedContent" value="# ✨ Selección Múltiple de Categorías&#10;&#10;##  Nueva Funcionalidad Implementada&#10;&#10;El admin ahora puede **seleccionar múltiples categorías** para cada receta usando chips interactivos.&#10;&#10;---&#10;&#10;##  Comparación&#10;&#10;### ❌ ANTES (Una Sola Categoría):&#10;```&#10;┌─────────────────────────────────┐&#10;│ Categoría: [Desayuno ▼]         │&#10;└─────────────────────────────────┘&#10;```&#10;- Solo podía elegir 1 categoría&#10;- Dropdown tradicional&#10;- Limitado&#10;&#10;### ✅ AHORA (Múltiples Categorías):&#10;```&#10;┌──────────────────────────────────────────┐&#10;│  Categorías * (Selecciona una o más)  │&#10;├──────────────────────────────────────────┤&#10;│ [✓  Desayuno] [ Almuerzo] [ Cena]│&#10;│ [ Postre] [ Bebidas] [ Snacks]   │&#10;│ [✓  Ensaladas] [ Sopas] [ Carnes]│&#10;│ ...más categorías...                     │&#10;│                                          │&#10;│ ┌──────────────────────────────────────┐ │&#10;│ │ Categorías seleccionadas:            │ │&#10;│ │ Desayuno, Ensaladas                  │ │&#10;│ └──────────────────────────────────────┘ │&#10;└──────────────────────────────────────────┘&#10;```&#10;- Puede seleccionar varias categorías&#10;- Chips visuales con iconos&#10;- Feedback instantáneo&#10;&#10;---&#10;&#10;##  Características del Sistema de Chips&#10;&#10;### 1. **Chips Interactivos**&#10;```kotlin&#10;FilterChip(&#10;    selected = seleccionada,&#10;    onClick = { /* toggle */ },&#10;    label = { Text(&quot; Desayuno&quot;) },&#10;    leadingIcon = { Icon(Check) } // Si está seleccionada&#10;)&#10;```&#10;&#10;### 2. **Estados Visuales**&#10;&#10;**No Seleccionado:**&#10;```&#10;[ Desayuno]&#10;```&#10;Fondo normal, sin check&#10;&#10;**Seleccionado:**&#10;```&#10;[✓  Desayuno]&#10;```&#10;Fondo de color, con check ✓&#10;&#10;### 3. **Layout FlowRow**&#10;Los chips se ajustan automáticamente en múltiples filas según el espacio disponible.&#10;&#10;### 4. **Resumen de Selección**&#10;```&#10;┌──────────────────────────────────────┐&#10;│ Categorías seleccionadas:            │&#10;│ Desayuno, Almuerzo, Vegetariana      │&#10;└──────────────────────────────────────┘&#10;```&#10;&#10;---&#10;&#10;##  Flujo de Uso&#10;&#10;### 1. Admin Abre el Formulario&#10;```&#10;Ver todos los chips de categorías disponibles&#10;(16 categorías con iconos)&#10;```&#10;&#10;### 2. Selecciona Categorías&#10;```&#10;Toca:  Desayuno → Se marca con ✓&#10;Toca:  Ensaladas → Se marca con ✓&#10;Toca:  Vegetariana → Se marca con ✓&#10;```&#10;&#10;### 3. Ve el Resumen&#10;```&#10;┌──────────────────────────────────────┐&#10;│ Categorías seleccionadas:            │&#10;│ Desayuno, Ensaladas, Vegetariana     │&#10;└──────────────────────────────────────┘&#10;```&#10;&#10;### 4. Notificación Automática&#10;```&#10;Si seleccionó &quot;Vegetariana&quot;:&#10;┌──────────────────────────────────────┐&#10;│ ℹ️ Esta receta será marcada como    │&#10;│    Vegetariana                     │&#10;└──────────────────────────────────────┘&#10;```&#10;&#10;### 5. Guarda la Receta&#10;```&#10;categoria: &quot;Desayuno&quot; (primera seleccionada)&#10;esVegetariana: true (detectado automáticamente)&#10;```&#10;&#10;---&#10;&#10;##  Almacenamiento&#10;&#10;```kotlin&#10;// En el código:&#10;var categoriasSeleccionadas by remember { &#10;    mutableStateOf(setOf&lt;String&gt;()) &#10;}&#10;&#10;// Al guardar:&#10;val nuevaReceta = Receta(&#10;    categoria = categoriasSeleccionadas.firstOrNull() ?: &quot;&quot;,&#10;    // ...otros campos&#10;)&#10;```&#10;&#10;**Nota**: Actualmente se guarda solo la primera categoría seleccionada en el campo `categoria`, pero el sistema está preparado para futuras extensiones donde se puedan almacenar todas las categorías.&#10;&#10;---&#10;&#10;## ✨ Casos de Uso&#10;&#10;### Caso 1: Receta Multifacética&#10;```&#10;Receta: &quot;Smoothie Bowl&quot;&#10;Categorías: Desayuno + Snacks + Vegetariana + Vegana&#10;&#10;✅ Aparece cuando el usuario filtra por &quot;Desayuno&quot;&#10;✅ Marcada automáticamente como vegetariana&#10;✅ Marcada automáticamente como vegana&#10;```&#10;&#10;### Caso 2: Receta de Horario Flexible&#10;```&#10;Receta: &quot;Sándwich Gourmet&quot;&#10;Categorías: Desayuno + Almuerzo + Cena&#10;&#10;✅ Aparece en todos esos filtros&#10;✅ Máxima visibilidad&#10;```&#10;&#10;### Caso 3: Receta con Características&#10;```&#10;Receta: &quot;Ensalada César&quot;&#10;Categorías: Ensaladas + Económica + Rápidas&#10;&#10;✅ Aparece en 3 filtros diferentes&#10;✅ Más oportunidades de ser encontrada&#10;```&#10;&#10;---&#10;&#10;##  Ventajas&#10;&#10;### 1. **Mayor Flexibilidad**&#10;✅ Una receta puede aparecer en múltiples categorías&#10;✅ No necesitas elegir una sola&#10;&#10;### 2. **Mejor Descubrimiento**&#10;✅ Las recetas son más fáciles de encontrar&#10;✅ Más puntos de acceso para los usuarios&#10;&#10;### 3. **Clasificación Precisa**&#10;✅ Puedes ser específico y general al mismo tiempo&#10;✅ &quot;Desayuno + Vegetariana + Rápidas&quot;&#10;&#10;### 4. **Visual e Intuitivo**&#10;✅ Chips con iconos&#10;✅ Feedback visual inmediato&#10;✅ Fácil de entender y usar&#10;&#10;---&#10;&#10;##  Detalles Técnicos&#10;&#10;### Estructura de Datos:&#10;```kotlin&#10;// Estado interno (múltiples categorías)&#10;var categoriasSeleccionadas: Set&lt;String&gt;&#10;&#10;// Ejemplos:&#10;setOf(&quot;Desayuno&quot;, &quot;Vegetariana&quot;)&#10;setOf(&quot;Almuerzo&quot;, &quot;Carnes&quot;, &quot;Económica&quot;)&#10;```&#10;&#10;### Validación:&#10;```kotlin&#10;enabled = nombre.isNotBlank() &amp;&amp; categoriasSeleccionadas.isNotEmpty()&#10;```&#10;El botón &quot;GUARDAR&quot; se habilita solo si hay al menos una categoría seleccionada.&#10;&#10;### Detección Automática:&#10;```kotlin&#10;val esVegetariana = categoriasSeleccionadas.any { &#10;    it.equals(&quot;Vegetariana&quot;, ignoreCase = true) &#10;} || categoriasSeleccionadas.any { &#10;    it.equals(&quot;Vegana&quot;, ignoreCase = true) &#10;}&#10;```&#10;&#10;---&#10;&#10;##  Experiencia del Usuario&#10;&#10;### Admin Crea Receta:&#10;```&#10;1. Llena nombre y descripción&#10;2. Ve grid de chips con todas las categorías&#10;3. Toca chips para seleccionar (✓ aparece)&#10;4. Ve resumen de categorías seleccionadas&#10;5. Si seleccionó &quot;Vegetariana&quot;, ve notificación&#10;6. Guarda con confianza&#10;```&#10;&#10;### Usuario Final:&#10;```&#10;1. Filtra por &quot;Desayuno&quot;&#10;2. Ve la receta que el admin marcó con &quot;Desayuno&quot;&#10;3. También la ve si filtra por otras categorías marcadas&#10;4. ✅ Más oportunidades de descubrir la receta&#10;```&#10;&#10;---&#10;&#10;##  Resultado&#10;&#10;```&#10;╔════════════════════════════════════════╗&#10;║                                        ║&#10;║  SELECCIÓN MÚLTIPLE DE CATEGORÍAS     ║&#10;║                                        ║&#10;║  ✅ Chips interactivos                ║&#10;║  ✅ Selección visual con ✓            ║&#10;║  ✅ Resumen de seleccionadas          ║&#10;║  ✅ Iconos en cada categoría          ║&#10;║  ✅ FlowRow adaptativo                ║&#10;║  ✅ Detección automática              ║&#10;║                                        ║&#10;╚════════════════════════════════════════╝&#10;```&#10;&#10;¡El admin ahora tiene mucha más flexibilidad para clasificar recetas! &#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/data/model/ChatModels.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/data/model/ChatModels.kt" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="package com.example.saborforaneo.data.model&#10;&#10;import com.google.gson.annotations.SerializedName&#10;&#10;/**&#10; * Modelo para enviar mensajes al backend&#10; */&#10;data class ChatRequest(&#10;    @SerializedName(&quot;message&quot;)&#10;    val message: String&#10;)&#10;&#10;/**&#10; * Modelo para recibir respuestas del backend&#10; */&#10;data class ChatResponse(&#10;    @SerializedName(&quot;reply&quot;)&#10;    val reply: String&#10;)&#10;&#10;/**&#10; * Modelo para representar un mensaje en la conversación&#10; */&#10;data class ChatMessage(&#10;    val id: String = System.currentTimeMillis().toString(),&#10;    val text: String,&#10;    val isUser: Boolean,&#10;    val timestamp: Long = System.currentTimeMillis(),&#10;    val isLoading: Boolean = false&#10;)&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/data/remote/api/GeminiApiService.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/data/remote/api/GeminiApiService.kt" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="package com.example.saborforaneo.data.remote.api&#10;&#10;import com.example.saborforaneo.data.model.ChatRequest&#10;import com.example.saborforaneo.data.model.ChatResponse&#10;import retrofit2.http.Body&#10;import retrofit2.http.POST&#10;&#10;/**&#10; * Interface para definir los endpoints de la API de Gemini&#10; */&#10;interface GeminiApiService {&#10;&#10;    /**&#10;     * Enviar un mensaje al chatbot de Gemini&#10;     * @param request Objeto con el mensaje del usuario&#10;     * @return Respuesta del chatbot&#10;     */&#10;    @POST(&quot;chat&quot;)&#10;    suspend fun sendMessage(@Body request: ChatRequest): ChatResponse&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/data/repository/ChatRepository.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/data/repository/ChatRepository.kt" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="package com.example.saborforaneo.data.repository&#10;&#10;import com.example.saborforaneo.data.model.ChatRequest&#10;import com.example.saborforaneo.data.model.ChatResponse&#10;import com.example.saborforaneo.data.remote.api.RetrofitClient&#10;import kotlinx.coroutines.Dispatchers&#10;import kotlinx.coroutines.withContext&#10;&#10;/**&#10; * Repository para manejar las operaciones del chat con Gemini&#10; */&#10;class ChatRepository {&#10;&#10;    private val api = RetrofitClient.geminiApi&#10;&#10;    /**&#10;     * Enviar mensaje al backend de Gemini&#10;     */&#10;    suspend fun sendMessage(message: String): Result&lt;ChatResponse&gt; {&#10;        return withContext(Dispatchers.IO) {&#10;            try {&#10;                val request = ChatRequest(message = message)&#10;                val response = api.sendMessage(request)&#10;                Result.success(response)&#10;            } catch (e: Exception) {&#10;                Result.failure(e)&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/ui/components/ChatMessageBubble.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/ui/components/ChatMessageBubble.kt" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="package com.example.saborforaneo.ui.components&#10;&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.saborforaneo.data.model.ChatMessage&#10;import java.text.SimpleDateFormat&#10;import java.util.*&#10;&#10;/**&#10; * Burbuja de mensaje del chat&#10; */&#10;@Composable&#10;fun ChatMessageBubble(&#10;    message: ChatMessage,&#10;    modifier: Modifier = Modifier&#10;) {&#10;    val alignment = if (message.isUser) Alignment.End else Alignment.Start&#10;    val backgroundColor = if (message.isUser) {&#10;        MaterialTheme.colorScheme.primary&#10;    } else {&#10;        MaterialTheme.colorScheme.surfaceVariant&#10;    }&#10;    val textColor = if (message.isUser) {&#10;        MaterialTheme.colorScheme.onPrimary&#10;    } else {&#10;        MaterialTheme.colorScheme.onSurfaceVariant&#10;    }&#10;&#10;    Column(&#10;        modifier = modifier&#10;            .fillMaxWidth()&#10;            .padding(horizontal = 16.dp, vertical = 4.dp),&#10;        horizontalAlignment = alignment&#10;    ) {&#10;        Box(&#10;            modifier = Modifier&#10;                .widthIn(max = 280.dp)&#10;                .clip(&#10;                    RoundedCornerShape(&#10;                        topStart = 16.dp,&#10;                        topEnd = 16.dp,&#10;                        bottomStart = if (message.isUser) 16.dp else 4.dp,&#10;                        bottomEnd = if (message.isUser) 4.dp else 16.dp&#10;                    )&#10;                )&#10;                .background(backgroundColor)&#10;                .padding(12.dp)&#10;        ) {&#10;            if (message.isLoading) {&#10;                // Indicador de carga&#10;                Row(&#10;                    verticalAlignment = Alignment.CenterVertically,&#10;                    horizontalArrangement = Arrangement.spacedBy(4.dp)&#10;                ) {&#10;                    repeat(3) {&#10;                        CircularProgressIndicator(&#10;                            modifier = Modifier.size(8.dp),&#10;                            strokeWidth = 2.dp,&#10;                            color = textColor&#10;                        )&#10;                    }&#10;                }&#10;            } else {&#10;                Text(&#10;                    text = message.text,&#10;                    color = textColor,&#10;                    fontSize = 15.sp,&#10;                    lineHeight = 20.sp&#10;                )&#10;            }&#10;        }&#10;&#10;        // Timestamp&#10;        if (!message.isLoading) {&#10;            Text(&#10;                text = formatTimestamp(message.timestamp),&#10;                fontSize = 11.sp,&#10;                color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.5f),&#10;                modifier = Modifier.padding(horizontal = 8.dp, vertical = 2.dp)&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;/**&#10; * Formatear timestamp a hora legible&#10; */&#10;private fun formatTimestamp(timestamp: Long): String {&#10;    val sdf = SimpleDateFormat(&quot;HH:mm&quot;, Locale.getDefault())&#10;    return sdf.format(Date(timestamp))&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/ui/screens/community/PantallaCrearReceta.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/ui/screens/community/PantallaCrearReceta.kt" />
              <option name="originalContent" value="package com.example.saborforaneo.ui.screens.community&#10;&#10;import android.net.Uri&#10;import androidx.activity.compose.rememberLauncherForActivityResult&#10;import androidx.activity.result.PickVisualMediaRequest&#10;import androidx.activity.result.contract.ActivityResultContracts&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.itemsIndexed&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.lifecycle.viewmodel.compose.viewModel&#10;import coil.compose.AsyncImage&#10;import com.example.saborforaneo.viewmodel.ComunidadViewModel&#10;import kotlinx.coroutines.launch&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun PantallaCrearReceta(&#10;    navegarAtras: () -&gt; Unit,&#10;    viewModel: ComunidadViewModel = viewModel()&#10;) {&#10;    var nombre by remember { mutableStateOf(&quot;&quot;) }&#10;    var descripcion by remember { mutableStateOf(&quot;&quot;) }&#10;    var categoria by remember { mutableStateOf(&quot;&quot;) }&#10;    var tiempoPreparacion by remember { mutableStateOf(&quot;&quot;) }&#10;    var porciones by remember { mutableStateOf(&quot;&quot;) }&#10;    var dificultad by remember { mutableStateOf(&quot;MEDIA&quot;) }&#10;    var ingredientes by remember { mutableStateOf(listOf(&quot;&quot;)) }&#10;    var pasos by remember { mutableStateOf(listOf(&quot;&quot;)) }&#10;    var esVegetariana by remember { mutableStateOf(false) }&#10;    var esVegana by remember { mutableStateOf(false) }&#10;    var imagenUrl by remember { mutableStateOf(&quot;&quot;) }&#10;    var mostrarDialogoCategoria by remember { mutableStateOf(false) }&#10;    var mostrarDialogoDificultad by remember { mutableStateOf(false) }&#10;&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    val categorias = listOf(&#10;        &quot; Pastas&quot;,&#10;        &quot; Pizzas&quot;,&#10;        &quot; Ensaladas&quot;,&#10;        &quot; Sopas&quot;,&#10;        &quot; Carnes&quot;,&#10;        &quot; Pescados&quot;,&#10;        &quot; Postres&quot;,&#10;        &quot; Bebidas&quot;,&#10;        &quot; Vegano&quot;,&#10;        &quot; Vegetariano&quot;&#10;    )&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = { Text(&quot;Crear Receta&quot;, fontWeight = FontWeight.Bold) },&#10;                navigationIcon = {&#10;                    IconButton(onClick = navegarAtras) {&#10;                        Icon(Icons.Default.ArrowBack, &quot;Volver&quot;)&#10;                    }&#10;                },&#10;                actions = {&#10;                    TextButton(&#10;                        onClick = {&#10;                            // Validar campos&#10;                            if (nombre.isBlank()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor ingresa el nombre de la receta&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;                            if (descripcion.isBlank()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor ingresa una descripción&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;                            if (categoria.isBlank()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor selecciona una categoría&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            if (imagenUrl.isBlank()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor ingresa la URL de la imagen&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            val tiempo = tiempoPreparacion.toIntOrNull()&#10;                            if (tiempo == null || tiempo &lt;= 0) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor ingresa un tiempo válido&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            val porcionesNum = porciones.toIntOrNull()&#10;                            if (porcionesNum == null || porcionesNum &lt;= 0) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor ingresa porciones válidas&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            val ingredientesFiltrados = ingredientes.filter { it.isNotBlank() }&#10;                            if (ingredientesFiltrados.isEmpty()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Agrega al menos un ingrediente&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            val pasosFiltrados = pasos.filter { it.isNotBlank() }&#10;                            if (pasosFiltrados.isEmpty()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Agrega al menos un paso&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            // Crear receta&#10;                            viewModel.crearReceta(&#10;                                nombre = nombre,&#10;                                descripcion = descripcion,&#10;                                categoria = categoria,&#10;                                tiempoPreparacion = tiempo,&#10;                                porciones = porcionesNum,&#10;                                dificultad = dificultad,&#10;                                ingredientes = ingredientesFiltrados,&#10;                                pasos = pasosFiltrados,&#10;                                esVegetariana = esVegetariana,&#10;                                esVegana = esVegana,&#10;                                imagenUrl = imagenUrl,&#10;                                imageUri = null,&#10;                                onSuccess = {&#10;                                    scope.launch {&#10;                                        snackbarHostState.showSnackbar(&quot;¡Receta creada exitosamente!&quot;)&#10;                                    }&#10;                                    navegarAtras()&#10;                                },&#10;                                onError = { error -&gt;&#10;                                    scope.launch {&#10;                                        snackbarHostState.showSnackbar(&quot;Error: $error&quot;)&#10;                                    }&#10;                                }&#10;                            )&#10;                        }&#10;                    ) {&#10;                        Text(&quot;PUBLICAR&quot;, fontWeight = FontWeight.Bold)&#10;                    }&#10;                }&#10;            )&#10;        },&#10;        snackbarHost = { SnackbarHost(snackbarHostState) }&#10;    ) { paddingValues -&gt;&#10;        LazyColumn(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(paddingValues),&#10;            contentPadding = PaddingValues(16.dp),&#10;            verticalArrangement = Arrangement.spacedBy(16.dp)&#10;        ) {&#10;            // URL de Imagen&#10;            item {&#10;                OutlinedTextField(&#10;                    value = imagenUrl,&#10;                    onValueChange = { imagenUrl = it },&#10;                    label = { Text(&quot;URL de la imagen *&quot;) },&#10;                    placeholder = { Text(&quot;https://ejemplo.com/imagen.jpg&quot;) },&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    singleLine = true,&#10;                    leadingIcon = {&#10;                        Icon(Icons.Default.AddPhotoAlternate, null)&#10;                    }&#10;                )&#10;            }&#10;&#10;            // Vista previa de la imagen (item separado)&#10;            if (imagenUrl.isNotEmpty()) {&#10;                item {&#10;                    var imagenCargada by remember(imagenUrl) { mutableStateOf(false) }&#10;                    var errorCarga by remember(imagenUrl) { mutableStateOf(false) }&#10;&#10;                    Column {&#10;                        Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                        Card(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .height(250.dp),&#10;                            colors = CardDefaults.cardColors(&#10;                                containerColor = MaterialTheme.colorScheme.surfaceVariant&#10;                            )&#10;                        ) {&#10;                            Box(&#10;                                modifier = Modifier.fillMaxSize(),&#10;                                contentAlignment = Alignment.Center&#10;                            ) {&#10;                                if (errorCarga) {&#10;                                    // Mostrar mensaje de error&#10;                                    Column(&#10;                                        horizontalAlignment = Alignment.CenterHorizontally,&#10;                                        verticalArrangement = Arrangement.Center&#10;                                    ) {&#10;                                        Icon(&#10;                                            imageVector = Icons.Default.BrokenImage,&#10;                                            contentDescription = &quot;Error&quot;,&#10;                                            modifier = Modifier.size(64.dp),&#10;                                            tint = MaterialTheme.colorScheme.error&#10;                                        )&#10;                                        Spacer(modifier = Modifier.height(8.dp))&#10;                                        Text(&#10;                                            &quot;No se pudo cargar la imagen&quot;,&#10;                                            style = MaterialTheme.typography.bodyMedium,&#10;                                            color = MaterialTheme.colorScheme.error&#10;                                        )&#10;                                        Text(&#10;                                            &quot;Verifica que la URL sea correcta&quot;,&#10;                                            style = MaterialTheme.typography.bodySmall,&#10;                                            color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                                        )&#10;                                    }&#10;                                } else {&#10;                                    // Mostrar imagen&#10;                                    AsyncImage(&#10;                                        model = imagenUrl,&#10;                                        contentDescription = &quot;Vista previa&quot;,&#10;                                        modifier = Modifier.fillMaxSize(),&#10;                                        contentScale = ContentScale.Crop,&#10;                                        onSuccess = {&#10;                                            imagenCargada = true&#10;                                            errorCarga = false&#10;                                        },&#10;                                        onError = {&#10;                                            imagenCargada = false&#10;                                            errorCarga = true&#10;                                        }&#10;                                    )&#10;&#10;                                    // Indicador de carga&#10;                                    if (!imagenCargada &amp;&amp; !errorCarga) {&#10;                                        CircularProgressIndicator()&#10;                                    }&#10;                                }&#10;                            }&#10;                        }&#10;&#10;                        // Mensaje informativo&#10;                        if (imagenCargada) {&#10;                            Spacer(modifier = Modifier.height(4.dp))&#10;                            Text(&#10;                                &quot;✓ Imagen cargada correctamente&quot;,&#10;                                style = MaterialTheme.typography.bodySmall,&#10;                                color = MaterialTheme.colorScheme.primary,&#10;                                modifier = Modifier.padding(start = 4.dp)&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            // Nombre&#10;            item {&#10;                OutlinedTextField(&#10;                    value = nombre,&#10;                    onValueChange = { nombre = it },&#10;                    label = { Text(&quot;Nombre de la receta *&quot;) },&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    singleLine = true&#10;                )&#10;            }&#10;&#10;            // Descripción&#10;            item {&#10;                OutlinedTextField(&#10;                    value = descripcion,&#10;                    onValueChange = { descripcion = it },&#10;                    label = { Text(&quot;Descripción *&quot;) },&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    minLines = 3,&#10;                    maxLines = 5&#10;                )&#10;            }&#10;&#10;            // Categoría&#10;            item {&#10;                OutlinedTextField(&#10;                    value = categoria,&#10;                    onValueChange = { },&#10;                    label = { Text(&quot;Categoría *&quot;) },&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .clickable { mostrarDialogoCategoria = true },&#10;                    enabled = false,&#10;                    colors = OutlinedTextFieldDefaults.colors(&#10;                        disabledTextColor = MaterialTheme.colorScheme.onSurface,&#10;                        disabledBorderColor = MaterialTheme.colorScheme.outline,&#10;                        disabledLabelColor = MaterialTheme.colorScheme.onSurfaceVariant&#10;                    ),&#10;                    trailingIcon = {&#10;                        Icon(Icons.Default.ArrowDropDown, null)&#10;                    }&#10;                )&#10;            }&#10;&#10;            // Tiempo y porciones&#10;            item {&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                ) {&#10;                    OutlinedTextField(&#10;                        value = tiempoPreparacion,&#10;                        onValueChange = { if (it.all { char -&gt; char.isDigit() }) tiempoPreparacion = it },&#10;                        label = { Text(&quot;Tiempo (min) *&quot;) },&#10;                        modifier = Modifier.weight(1f),&#10;                        singleLine = true,&#10;                        leadingIcon = { Icon(Icons.Default.Timer, null) }&#10;                    )&#10;                    OutlinedTextField(&#10;                        value = porciones,&#10;                        onValueChange = { if (it.all { char -&gt; char.isDigit() }) porciones = it },&#10;                        label = { Text(&quot;Porciones *&quot;) },&#10;                        modifier = Modifier.weight(1f),&#10;                        singleLine = true,&#10;                        leadingIcon = { Icon(Icons.Default.Restaurant, null) }&#10;                    )&#10;                }&#10;            }&#10;&#10;            // Dificultad&#10;            item {&#10;                OutlinedTextField(&#10;                    value = when (dificultad) {&#10;                        &quot;FACIL&quot; -&gt; &quot;Fácil&quot;&#10;                        &quot;MEDIA&quot; -&gt; &quot;Media&quot;&#10;                        &quot;DIFICIL&quot; -&gt; &quot;Difícil&quot;&#10;                        else -&gt; &quot;Media&quot;&#10;                    },&#10;                    onValueChange = { },&#10;                    label = { Text(&quot;Dificultad&quot;) },&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .clickable { mostrarDialogoDificultad = true },&#10;                    enabled = false,&#10;                    colors = OutlinedTextFieldDefaults.colors(&#10;                        disabledTextColor = MaterialTheme.colorScheme.onSurface,&#10;                        disabledBorderColor = MaterialTheme.colorScheme.outline,&#10;                        disabledLabelColor = MaterialTheme.colorScheme.onSurfaceVariant&#10;                    ),&#10;                    trailingIcon = {&#10;                        Icon(Icons.Default.ArrowDropDown, null)&#10;                    }&#10;                )&#10;            }&#10;&#10;            // Ingredientes&#10;            item {&#10;                Text(&#10;                    &quot;Ingredientes *&quot;,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;            }&#10;&#10;            itemsIndexed(ingredientes) { index, ingrediente -&gt;&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.spacedBy(8.dp),&#10;                    verticalAlignment = Alignment.CenterVertically&#10;                ) {&#10;                    OutlinedTextField(&#10;                        value = ingrediente,&#10;                        onValueChange = { newValue -&gt;&#10;                            ingredientes = ingredientes.toMutableList().apply {&#10;                                this[index] = newValue&#10;                            }&#10;                        },&#10;                        label = { Text(&quot;Ingrediente ${index + 1}&quot;) },&#10;                        modifier = Modifier.weight(1f),&#10;                        singleLine = true&#10;                    )&#10;                    if (ingredientes.size &gt; 1) {&#10;                        IconButton(&#10;                            onClick = {&#10;                                ingredientes = ingredientes.toMutableList().apply {&#10;                                    removeAt(index)&#10;                                }&#10;                            }&#10;                        ) {&#10;                            Icon(Icons.Default.Delete, &quot;Eliminar&quot;, tint = MaterialTheme.colorScheme.error)&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                TextButton(&#10;                    onClick = {&#10;                        ingredientes = ingredientes + &quot;&quot;&#10;                    },&#10;                    modifier = Modifier.fillMaxWidth()&#10;                ) {&#10;                    Icon(Icons.Default.Add, null)&#10;                    Spacer(Modifier.width(8.dp))&#10;                    Text(&quot;Agregar ingrediente&quot;)&#10;                }&#10;            }&#10;&#10;            // Pasos&#10;            item {&#10;                Text(&#10;                    &quot;Pasos de preparación *&quot;,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;            }&#10;&#10;            itemsIndexed(pasos) { index, paso -&gt;&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.spacedBy(8.dp),&#10;                    verticalAlignment = Alignment.Top&#10;                ) {&#10;                    OutlinedTextField(&#10;                        value = paso,&#10;                        onValueChange = { newValue -&gt;&#10;                            pasos = pasos.toMutableList().apply {&#10;                                this[index] = newValue&#10;                            }&#10;                        },&#10;                        label = { Text(&quot;Paso ${index + 1}&quot;) },&#10;                        modifier = Modifier.weight(1f),&#10;                        minLines = 2,&#10;                        maxLines = 4&#10;                    )&#10;                    if (pasos.size &gt; 1) {&#10;                        IconButton(&#10;                            onClick = {&#10;                                pasos = pasos.toMutableList().apply {&#10;                                    removeAt(index)&#10;                                }&#10;                            }&#10;                        ) {&#10;                            Icon(Icons.Default.Delete, &quot;Eliminar&quot;, tint = MaterialTheme.colorScheme.error)&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                TextButton(&#10;                    onClick = {&#10;                        pasos = pasos + &quot;&quot;&#10;                    },&#10;                    modifier = Modifier.fillMaxWidth()&#10;                ) {&#10;                    Icon(Icons.Default.Add, null)&#10;                    Spacer(Modifier.width(8.dp))&#10;                    Text(&quot;Agregar paso&quot;)&#10;                }&#10;            }&#10;&#10;            item {&#10;                Spacer(Modifier.height(80.dp))&#10;            }&#10;        }&#10;    }&#10;&#10;    // Diálogo de categoría&#10;    if (mostrarDialogoCategoria) {&#10;        AlertDialog(&#10;            onDismissRequest = { mostrarDialogoCategoria = false },&#10;            title = { Text(&quot;Selecciona una categoría&quot;) },&#10;            text = {&#10;                LazyColumn {&#10;                    items(categorias.size) { index -&gt;&#10;                        TextButton(&#10;                            onClick = {&#10;                                categoria = categorias[index]&#10;                                mostrarDialogoCategoria = false&#10;                            },&#10;                            modifier = Modifier.fillMaxWidth()&#10;                        ) {&#10;                            Text(&#10;                                categorias[index],&#10;                                modifier = Modifier.fillMaxWidth()&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            },&#10;            confirmButton = {&#10;                TextButton(onClick = { mostrarDialogoCategoria = false }) {&#10;                    Text(&quot;Cancelar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;&#10;    // Diálogo de dificultad&#10;    if (mostrarDialogoDificultad) {&#10;        AlertDialog(&#10;            onDismissRequest = { mostrarDialogoDificultad = false },&#10;            title = { Text(&quot;Selecciona la dificultad&quot;) },&#10;            text = {&#10;                Column {&#10;                    listOf(&quot;FACIL&quot; to &quot;Fácil&quot;, &quot;MEDIA&quot; to &quot;Media&quot;, &quot;DIFICIL&quot; to &quot;Difícil&quot;).forEach { (value, label) -&gt;&#10;                        TextButton(&#10;                            onClick = {&#10;                                dificultad = value&#10;                                mostrarDialogoDificultad = false&#10;                            },&#10;                            modifier = Modifier.fillMaxWidth()&#10;                        ) {&#10;                            Text(label, modifier = Modifier.fillMaxWidth())&#10;                        }&#10;                    }&#10;                }&#10;            },&#10;            confirmButton = {&#10;                TextButton(onClick = { mostrarDialogoDificultad = false }) {&#10;                    Text(&quot;Cancelar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.saborforaneo.ui.screens.community&#10;&#10;import android.net.Uri&#10;import androidx.activity.compose.rememberLauncherForActivityResult&#10;import androidx.activity.result.PickVisualMediaRequest&#10;import androidx.activity.result.contract.ActivityResultContracts&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.itemsIndexed&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.lifecycle.viewmodel.compose.viewModel&#10;import coil.compose.AsyncImage&#10;import com.example.saborforaneo.util.Categorias&#10;import com.example.saborforaneo.viewmodel.ComunidadViewModel&#10;import kotlinx.coroutines.launch&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun PantallaCrearReceta(&#10;    navegarAtras: () -&gt; Unit,&#10;    viewModel: ComunidadViewModel = viewModel()&#10;) {&#10;    var nombre by remember { mutableStateOf(&quot;&quot;) }&#10;    var descripcion by remember { mutableStateOf(&quot;&quot;) }&#10;    var categoria by remember { mutableStateOf(&quot;&quot;) }&#10;    var tiempoPreparacion by remember { mutableStateOf(&quot;&quot;) }&#10;    var porciones by remember { mutableStateOf(&quot;&quot;) }&#10;    var dificultad by remember { mutableStateOf(&quot;MEDIA&quot;) }&#10;    var ingredientes by remember { mutableStateOf(listOf(&quot;&quot;)) }&#10;    var pasos by remember { mutableStateOf(listOf(&quot;&quot;)) }&#10;    var esVegetariana by remember { mutableStateOf(false) }&#10;    var esVegana by remember { mutableStateOf(false) }&#10;    var imagenUrl by remember { mutableStateOf(&quot;&quot;) }&#10;    var mostrarDialogoCategoria by remember { mutableStateOf(false) }&#10;    var mostrarDialogoDificultad by remember { mutableStateOf(false) }&#10;&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    // Usar categorías centralizadas (mismas que el admin y que ve el usuario)&#10;    val categorias = Categorias.lista&#10;        .filter { it.nombre != &quot;Todas&quot; }  // Quitar &quot;Todas&quot;&#10;        .map { &quot;${it.icono} ${it.nombre}&quot; }  // Formato: &quot; Pastas&quot;&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = { Text(&quot;Crear Receta&quot;, fontWeight = FontWeight.Bold) },&#10;                navigationIcon = {&#10;                    IconButton(onClick = navegarAtras) {&#10;                        Icon(Icons.Default.ArrowBack, &quot;Volver&quot;)&#10;                    }&#10;                },&#10;                actions = {&#10;                    TextButton(&#10;                        onClick = {&#10;                            // Validar campos&#10;                            if (nombre.isBlank()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor ingresa el nombre de la receta&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;                            if (descripcion.isBlank()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor ingresa una descripción&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;                            if (categoria.isBlank()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor selecciona una categoría&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            if (imagenUrl.isBlank()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor ingresa la URL de la imagen&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            val tiempo = tiempoPreparacion.toIntOrNull()&#10;                            if (tiempo == null || tiempo &lt;= 0) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor ingresa un tiempo válido&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            val porcionesNum = porciones.toIntOrNull()&#10;                            if (porcionesNum == null || porcionesNum &lt;= 0) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Por favor ingresa porciones válidas&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            val ingredientesFiltrados = ingredientes.filter { it.isNotBlank() }&#10;                            if (ingredientesFiltrados.isEmpty()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Agrega al menos un ingrediente&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            val pasosFiltrados = pasos.filter { it.isNotBlank() }&#10;                            if (pasosFiltrados.isEmpty()) {&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&quot;Agrega al menos un paso&quot;)&#10;                                }&#10;                                return@TextButton&#10;                            }&#10;&#10;                            // Crear receta&#10;                            viewModel.crearReceta(&#10;                                nombre = nombre,&#10;                                descripcion = descripcion,&#10;                                categoria = categoria,&#10;                                tiempoPreparacion = tiempo,&#10;                                porciones = porcionesNum,&#10;                                dificultad = dificultad,&#10;                                ingredientes = ingredientesFiltrados,&#10;                                pasos = pasosFiltrados,&#10;                                esVegetariana = esVegetariana,&#10;                                esVegana = esVegana,&#10;                                imagenUrl = imagenUrl,&#10;                                imageUri = null,&#10;                                onSuccess = {&#10;                                    scope.launch {&#10;                                        snackbarHostState.showSnackbar(&quot;¡Receta creada exitosamente!&quot;)&#10;                                    }&#10;                                    navegarAtras()&#10;                                },&#10;                                onError = { error -&gt;&#10;                                    scope.launch {&#10;                                        snackbarHostState.showSnackbar(&quot;Error: $error&quot;)&#10;                                    }&#10;                                }&#10;                            )&#10;                        }&#10;                    ) {&#10;                        Text(&quot;PUBLICAR&quot;, fontWeight = FontWeight.Bold)&#10;                    }&#10;                }&#10;            )&#10;        },&#10;        snackbarHost = { SnackbarHost(snackbarHostState) }&#10;    ) { paddingValues -&gt;&#10;        LazyColumn(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(paddingValues),&#10;            contentPadding = PaddingValues(16.dp),&#10;            verticalArrangement = Arrangement.spacedBy(16.dp)&#10;        ) {&#10;            // URL de Imagen&#10;            item {&#10;                OutlinedTextField(&#10;                    value = imagenUrl,&#10;                    onValueChange = { imagenUrl = it },&#10;                    label = { Text(&quot;URL de la imagen *&quot;) },&#10;                    placeholder = { Text(&quot;https://ejemplo.com/imagen.jpg&quot;) },&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    singleLine = true,&#10;                    leadingIcon = {&#10;                        Icon(Icons.Default.AddPhotoAlternate, null)&#10;                    }&#10;                )&#10;            }&#10;&#10;            // Vista previa de la imagen (item separado)&#10;            if (imagenUrl.isNotEmpty()) {&#10;                item {&#10;                    var imagenCargada by remember(imagenUrl) { mutableStateOf(false) }&#10;                    var errorCarga by remember(imagenUrl) { mutableStateOf(false) }&#10;&#10;                    Column {&#10;                        Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                        Card(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .height(250.dp),&#10;                            colors = CardDefaults.cardColors(&#10;                                containerColor = MaterialTheme.colorScheme.surfaceVariant&#10;                            )&#10;                        ) {&#10;                            Box(&#10;                                modifier = Modifier.fillMaxSize(),&#10;                                contentAlignment = Alignment.Center&#10;                            ) {&#10;                                if (errorCarga) {&#10;                                    // Mostrar mensaje de error&#10;                                    Column(&#10;                                        horizontalAlignment = Alignment.CenterHorizontally,&#10;                                        verticalArrangement = Arrangement.Center&#10;                                    ) {&#10;                                        Icon(&#10;                                            imageVector = Icons.Default.BrokenImage,&#10;                                            contentDescription = &quot;Error&quot;,&#10;                                            modifier = Modifier.size(64.dp),&#10;                                            tint = MaterialTheme.colorScheme.error&#10;                                        )&#10;                                        Spacer(modifier = Modifier.height(8.dp))&#10;                                        Text(&#10;                                            &quot;No se pudo cargar la imagen&quot;,&#10;                                            style = MaterialTheme.typography.bodyMedium,&#10;                                            color = MaterialTheme.colorScheme.error&#10;                                        )&#10;                                        Text(&#10;                                            &quot;Verifica que la URL sea correcta&quot;,&#10;                                            style = MaterialTheme.typography.bodySmall,&#10;                                            color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                                        )&#10;                                    }&#10;                                } else {&#10;                                    // Mostrar imagen&#10;                                    AsyncImage(&#10;                                        model = imagenUrl,&#10;                                        contentDescription = &quot;Vista previa&quot;,&#10;                                        modifier = Modifier.fillMaxSize(),&#10;                                        contentScale = ContentScale.Crop,&#10;                                        onSuccess = {&#10;                                            imagenCargada = true&#10;                                            errorCarga = false&#10;                                        },&#10;                                        onError = {&#10;                                            imagenCargada = false&#10;                                            errorCarga = true&#10;                                        }&#10;                                    )&#10;&#10;                                    // Indicador de carga&#10;                                    if (!imagenCargada &amp;&amp; !errorCarga) {&#10;                                        CircularProgressIndicator()&#10;                                    }&#10;                                }&#10;                            }&#10;                        }&#10;&#10;                        // Mensaje informativo&#10;                        if (imagenCargada) {&#10;                            Spacer(modifier = Modifier.height(4.dp))&#10;                            Text(&#10;                                &quot;✓ Imagen cargada correctamente&quot;,&#10;                                style = MaterialTheme.typography.bodySmall,&#10;                                color = MaterialTheme.colorScheme.primary,&#10;                                modifier = Modifier.padding(start = 4.dp)&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            // Nombre&#10;            item {&#10;                OutlinedTextField(&#10;                    value = nombre,&#10;                    onValueChange = { nombre = it },&#10;                    label = { Text(&quot;Nombre de la receta *&quot;) },&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    singleLine = true&#10;                )&#10;            }&#10;&#10;            // Descripción&#10;            item {&#10;                OutlinedTextField(&#10;                    value = descripcion,&#10;                    onValueChange = { descripcion = it },&#10;                    label = { Text(&quot;Descripción *&quot;) },&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    minLines = 3,&#10;                    maxLines = 5&#10;                )&#10;            }&#10;&#10;            // Categoría&#10;            item {&#10;                OutlinedTextField(&#10;                    value = categoria,&#10;                    onValueChange = { },&#10;                    label = { Text(&quot;Categoría *&quot;) },&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .clickable { mostrarDialogoCategoria = true },&#10;                    enabled = false,&#10;                    colors = OutlinedTextFieldDefaults.colors(&#10;                        disabledTextColor = MaterialTheme.colorScheme.onSurface,&#10;                        disabledBorderColor = MaterialTheme.colorScheme.outline,&#10;                        disabledLabelColor = MaterialTheme.colorScheme.onSurfaceVariant&#10;                    ),&#10;                    trailingIcon = {&#10;                        Icon(Icons.Default.ArrowDropDown, null)&#10;                    }&#10;                )&#10;            }&#10;&#10;            // Tiempo y porciones&#10;            item {&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                ) {&#10;                    OutlinedTextField(&#10;                        value = tiempoPreparacion,&#10;                        onValueChange = { if (it.all { char -&gt; char.isDigit() }) tiempoPreparacion = it },&#10;                        label = { Text(&quot;Tiempo (min) *&quot;) },&#10;                        modifier = Modifier.weight(1f),&#10;                        singleLine = true,&#10;                        leadingIcon = { Icon(Icons.Default.Timer, null) }&#10;                    )&#10;                    OutlinedTextField(&#10;                        value = porciones,&#10;                        onValueChange = { if (it.all { char -&gt; char.isDigit() }) porciones = it },&#10;                        label = { Text(&quot;Porciones *&quot;) },&#10;                        modifier = Modifier.weight(1f),&#10;                        singleLine = true,&#10;                        leadingIcon = { Icon(Icons.Default.Restaurant, null) }&#10;                    )&#10;                }&#10;            }&#10;&#10;            // Dificultad&#10;            item {&#10;                OutlinedTextField(&#10;                    value = when (dificultad) {&#10;                        &quot;FACIL&quot; -&gt; &quot;Fácil&quot;&#10;                        &quot;MEDIA&quot; -&gt; &quot;Media&quot;&#10;                        &quot;DIFICIL&quot; -&gt; &quot;Difícil&quot;&#10;                        else -&gt; &quot;Media&quot;&#10;                    },&#10;                    onValueChange = { },&#10;                    label = { Text(&quot;Dificultad&quot;) },&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .clickable { mostrarDialogoDificultad = true },&#10;                    enabled = false,&#10;                    colors = OutlinedTextFieldDefaults.colors(&#10;                        disabledTextColor = MaterialTheme.colorScheme.onSurface,&#10;                        disabledBorderColor = MaterialTheme.colorScheme.outline,&#10;                        disabledLabelColor = MaterialTheme.colorScheme.onSurfaceVariant&#10;                    ),&#10;                    trailingIcon = {&#10;                        Icon(Icons.Default.ArrowDropDown, null)&#10;                    }&#10;                )&#10;            }&#10;&#10;            // Ingredientes&#10;            item {&#10;                Text(&#10;                    &quot;Ingredientes *&quot;,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;            }&#10;&#10;            itemsIndexed(ingredientes) { index, ingrediente -&gt;&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.spacedBy(8.dp),&#10;                    verticalAlignment = Alignment.CenterVertically&#10;                ) {&#10;                    OutlinedTextField(&#10;                        value = ingrediente,&#10;                        onValueChange = { newValue -&gt;&#10;                            ingredientes = ingredientes.toMutableList().apply {&#10;                                this[index] = newValue&#10;                            }&#10;                        },&#10;                        label = { Text(&quot;Ingrediente ${index + 1}&quot;) },&#10;                        modifier = Modifier.weight(1f),&#10;                        singleLine = true&#10;                    )&#10;                    if (ingredientes.size &gt; 1) {&#10;                        IconButton(&#10;                            onClick = {&#10;                                ingredientes = ingredientes.toMutableList().apply {&#10;                                    removeAt(index)&#10;                                }&#10;                            }&#10;                        ) {&#10;                            Icon(Icons.Default.Delete, &quot;Eliminar&quot;, tint = MaterialTheme.colorScheme.error)&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                TextButton(&#10;                    onClick = {&#10;                        ingredientes = ingredientes + &quot;&quot;&#10;                    },&#10;                    modifier = Modifier.fillMaxWidth()&#10;                ) {&#10;                    Icon(Icons.Default.Add, null)&#10;                    Spacer(Modifier.width(8.dp))&#10;                    Text(&quot;Agregar ingrediente&quot;)&#10;                }&#10;            }&#10;&#10;            // Pasos&#10;            item {&#10;                Text(&#10;                    &quot;Pasos de preparación *&quot;,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;            }&#10;&#10;            itemsIndexed(pasos) { index, paso -&gt;&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.spacedBy(8.dp),&#10;                    verticalAlignment = Alignment.Top&#10;                ) {&#10;                    OutlinedTextField(&#10;                        value = paso,&#10;                        onValueChange = { newValue -&gt;&#10;                            pasos = pasos.toMutableList().apply {&#10;                                this[index] = newValue&#10;                            }&#10;                        },&#10;                        label = { Text(&quot;Paso ${index + 1}&quot;) },&#10;                        modifier = Modifier.weight(1f),&#10;                        minLines = 2,&#10;                        maxLines = 4&#10;                    )&#10;                    if (pasos.size &gt; 1) {&#10;                        IconButton(&#10;                            onClick = {&#10;                                pasos = pasos.toMutableList().apply {&#10;                                    removeAt(index)&#10;                                }&#10;                            }&#10;                        ) {&#10;                            Icon(Icons.Default.Delete, &quot;Eliminar&quot;, tint = MaterialTheme.colorScheme.error)&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                TextButton(&#10;                    onClick = {&#10;                        pasos = pasos + &quot;&quot;&#10;                    },&#10;                    modifier = Modifier.fillMaxWidth()&#10;                ) {&#10;                    Icon(Icons.Default.Add, null)&#10;                    Spacer(Modifier.width(8.dp))&#10;                    Text(&quot;Agregar paso&quot;)&#10;                }&#10;            }&#10;&#10;            item {&#10;                Spacer(Modifier.height(80.dp))&#10;            }&#10;        }&#10;    }&#10;&#10;    // Diálogo de categoría&#10;    if (mostrarDialogoCategoria) {&#10;        AlertDialog(&#10;            onDismissRequest = { mostrarDialogoCategoria = false },&#10;            title = { Text(&quot;Selecciona una categoría&quot;) },&#10;            text = {&#10;                LazyColumn {&#10;                    items(categorias.size) { index -&gt;&#10;                        TextButton(&#10;                            onClick = {&#10;                                categoria = categorias[index]&#10;                                mostrarDialogoCategoria = false&#10;                            },&#10;                            modifier = Modifier.fillMaxWidth()&#10;                        ) {&#10;                            Text(&#10;                                categorias[index],&#10;                                modifier = Modifier.fillMaxWidth()&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            },&#10;            confirmButton = {&#10;                TextButton(onClick = { mostrarDialogoCategoria = false }) {&#10;                    Text(&quot;Cancelar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;&#10;    // Diálogo de dificultad&#10;    if (mostrarDialogoDificultad) {&#10;        AlertDialog(&#10;            onDismissRequest = { mostrarDialogoDificultad = false },&#10;            title = { Text(&quot;Selecciona la dificultad&quot;) },&#10;            text = {&#10;                Column {&#10;                    listOf(&quot;FACIL&quot; to &quot;Fácil&quot;, &quot;MEDIA&quot; to &quot;Media&quot;, &quot;DIFICIL&quot; to &quot;Difícil&quot;).forEach { (value, label) -&gt;&#10;                        TextButton(&#10;                            onClick = {&#10;                                dificultad = value&#10;                                mostrarDialogoDificultad = false&#10;                            },&#10;                            modifier = Modifier.fillMaxWidth()&#10;                        ) {&#10;                            Text(label, modifier = Modifier.fillMaxWidth())&#10;                        }&#10;                    }&#10;                }&#10;            },&#10;            confirmButton = {&#10;                TextButton(onClick = { mostrarDialogoDificultad = false }) {&#10;                    Text(&quot;Cancelar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/ui/screens/community/PantallaDetalleRecetaComunidad.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/ui/screens/community/PantallaDetalleRecetaComunidad.kt" />
              <option name="originalContent" value="package com.example.saborforaneo.ui.screens.community&#10;&#10;import androidx.compose.foundation.BorderStroke&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.lazy.rememberLazyListState&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextOverflow&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import androidx.lifecycle.viewmodel.compose.viewModel&#10;import coil.compose.AsyncImage&#10;import com.example.saborforaneo.data.model.ComentarioReceta&#10;import com.example.saborforaneo.viewmodel.DetalleRecetaComunidadViewModel&#10;import com.google.firebase.auth.FirebaseAuth&#10;import kotlinx.coroutines.launch&#10;import java.text.SimpleDateFormat&#10;import java.util.*&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun PantallaDetalleRecetaComunidad(&#10;    recetaId: String,&#10;    navegarAtras: () -&gt; Unit,&#10;    scrollToComments: Boolean = false,&#10;    viewModel: DetalleRecetaComunidadViewModel = viewModel()&#10;) {&#10;    val uiState by viewModel.uiState.collectAsState()&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    val scope = rememberCoroutineScope()&#10;    val listState = rememberLazyListState()&#10;&#10;    LaunchedEffect(recetaId) {&#10;        viewModel.cargarReceta(recetaId)&#10;        viewModel.observarComentarios(recetaId)&#10;&#10;        // Si debe hacer scroll a comentarios, activar el flag&#10;        if (scrollToComments) {&#10;            viewModel.activarScrollAComentarios()&#10;        }&#10;    }&#10;&#10;    // Scroll automático a comentarios cuando se active el flag&#10;    LaunchedEffect(uiState.scrollToComments) {&#10;        if (uiState.scrollToComments) {&#10;            // Esperar un poco para que el contenido se renderice&#10;            kotlinx.coroutines.delay(300)&#10;            // Hacer scroll al índice donde empiezan los comentarios&#10;            // (aproximadamente después de imagen, info, ingredientes, pasos)&#10;            listState.animateScrollToItem(8) // Ajustar según la estructura&#10;            viewModel.desactivarScrollAComentarios()&#10;        }&#10;    }&#10;&#10;    LaunchedEffect(uiState.error) {&#10;        uiState.error?.let {&#10;            snackbarHostState.showSnackbar(it)&#10;            viewModel.limpiarError()&#10;        }&#10;    }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = { Text(&quot;Detalle de Receta&quot;, fontWeight = FontWeight.Bold) },&#10;                navigationIcon = {&#10;                    IconButton(onClick = navegarAtras) {&#10;                        Icon(Icons.Default.ArrowBack, &quot;Volver&quot;)&#10;                    }&#10;                }&#10;            )&#10;        },&#10;        snackbarHost = { SnackbarHost(snackbarHostState) }&#10;    ) { paddingValues -&gt;&#10;        if (uiState.cargando) {&#10;            Box(&#10;                modifier = Modifier&#10;                    .fillMaxSize()&#10;                    .padding(paddingValues),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        } else {&#10;            uiState.receta?.let { receta -&gt;&#10;                LazyColumn(&#10;                    state = listState,&#10;                    modifier = Modifier&#10;                        .fillMaxSize()&#10;                        .padding(paddingValues)&#10;                ) {&#10;                    // Imagen de la receta&#10;                    item {&#10;                        Box(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .height(300.dp)&#10;                                .background(MaterialTheme.colorScheme.surfaceVariant)&#10;                        ) {&#10;                            if (receta.imagenUrl.isNotEmpty()) {&#10;                                AsyncImage(&#10;                                    model = receta.imagenUrl,&#10;                                    contentDescription = receta.nombre,&#10;                                    modifier = Modifier.fillMaxSize(),&#10;                                    contentScale = ContentScale.Crop&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    // Información básica&#10;                    item {&#10;                        Column(&#10;                            modifier = Modifier.padding(16.dp)&#10;                        ) {&#10;                            // Autor&#10;                            Row(&#10;                                verticalAlignment = Alignment.CenterVertically,&#10;                                modifier = Modifier.padding(bottom = 12.dp)&#10;                            ) {&#10;                                if (receta.autorFoto.isNotEmpty()) {&#10;                                    AsyncImage(&#10;                                        model = receta.autorFoto,&#10;                                        contentDescription = receta.autorNombre,&#10;                                        modifier = Modifier&#10;                                            .size(40.dp)&#10;                                            .clip(CircleShape),&#10;                                        contentScale = ContentScale.Crop&#10;                                    )&#10;                                } else {&#10;                                    Box(&#10;                                        modifier = Modifier&#10;                                            .size(40.dp)&#10;                                            .clip(CircleShape)&#10;                                            .background(MaterialTheme.colorScheme.primaryContainer),&#10;                                        contentAlignment = Alignment.Center&#10;                                    ) {&#10;                                        Text(&#10;                                            text = receta.autorNombre.firstOrNull()?.toString()?.uppercase() ?: &quot;?&quot;,&#10;                                            fontWeight = FontWeight.Bold,&#10;                                            color = MaterialTheme.colorScheme.onPrimaryContainer&#10;                                        )&#10;                                    }&#10;                                }&#10;                                Spacer(modifier = Modifier.width(12.dp))&#10;                                Column {&#10;                                    Text(&#10;                                        text = receta.autorNombre,&#10;                                        fontWeight = FontWeight.Bold,&#10;                                        fontSize = 14.sp&#10;                                    )&#10;                                    Text(&#10;                                        text = formatearFecha(receta.fechaCreacion),&#10;                                        fontSize = 12.sp,&#10;                                        color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                                    )&#10;                                }&#10;                            }&#10;&#10;                            // Título&#10;                            Text(&#10;                                text = receta.nombre,&#10;                                fontSize = 24.sp,&#10;                                fontWeight = FontWeight.Bold&#10;                            )&#10;&#10;                            Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                            // Descripción&#10;                            Text(&#10;                                text = receta.descripcion,&#10;                                fontSize = 14.sp,&#10;                                color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                            )&#10;&#10;                            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                            // Info cards&#10;                            Row(&#10;                                modifier = Modifier.fillMaxWidth(),&#10;                                horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                            ) {&#10;                                InfoCard(&#10;                                    icon = &quot;⏱️&quot;,&#10;                                    label = &quot;${receta.tiempoPreparacion} min&quot;,&#10;                                    modifier = Modifier.weight(1f)&#10;                                )&#10;                                InfoCard(&#10;                                    icon = &quot;️&quot;,&#10;                                    label = &quot;${receta.porciones} porciones&quot;,&#10;                                    modifier = Modifier.weight(1f)&#10;                                )&#10;                                InfoCard(&#10;                                    icon = &quot;&quot;,&#10;                                    label = receta.dificultad.name,&#10;                                    modifier = Modifier.weight(1f)&#10;                                )&#10;                            }&#10;&#10;                            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                            // Likes y comentarios&#10;                            Row(&#10;                                modifier = Modifier.fillMaxWidth(),&#10;                                horizontalArrangement = Arrangement.spacedBy(16.dp)&#10;                            ) {&#10;                                val currentUserId = FirebaseAuth.getInstance().currentUser?.uid&#10;                                val leDioLike = receta.usuariosQueLikean.contains(currentUserId)&#10;&#10;                                Row(&#10;                                    verticalAlignment = Alignment.CenterVertically,&#10;                                    modifier = Modifier.clickable {&#10;                                        viewModel.toggleLike(recetaId)&#10;                                    }&#10;                                ) {&#10;                                    Icon(&#10;                                        imageVector = if (leDioLike) Icons.Filled.Favorite else Icons.Default.FavoriteBorder,&#10;                                        contentDescription = &quot;Like&quot;,&#10;                                        tint = if (leDioLike) MaterialTheme.colorScheme.error else MaterialTheme.colorScheme.onSurfaceVariant&#10;                                    )&#10;                                    Spacer(modifier = Modifier.width(4.dp))&#10;                                    Text(&#10;                                        text = &quot;${receta.likes}&quot;,&#10;                                        fontWeight = FontWeight.Medium&#10;                                    )&#10;                                }&#10;&#10;                                Row(&#10;                                    verticalAlignment = Alignment.CenterVertically&#10;                                ) {&#10;                                    Icon(&#10;                                        imageVector = Icons.Default.Comment,&#10;                                        contentDescription = &quot;Comentarios&quot;,&#10;                                        tint = MaterialTheme.colorScheme.onSurfaceVariant&#10;                                    )&#10;                                    Spacer(modifier = Modifier.width(4.dp))&#10;                                    Text(&#10;                                        text = &quot;${receta.comentarios}&quot;,&#10;                                        fontWeight = FontWeight.Medium&#10;                                    )&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    // Ingredientes&#10;                    item {&#10;                        Column(modifier = Modifier.padding(horizontal = 16.dp)) {&#10;                            Text(&#10;                                text = &quot;Ingredientes&quot;,&#10;                                fontSize = 20.sp,&#10;                                fontWeight = FontWeight.Bold,&#10;                                modifier = Modifier.padding(bottom = 8.dp)&#10;                            )&#10;                            receta.ingredientes.forEach { ingrediente -&gt;&#10;                                Row(&#10;                                    modifier = Modifier.padding(vertical = 4.dp)&#10;                                ) {&#10;                                    Text(&quot;• &quot;, fontSize = 16.sp)&#10;                                    Text(ingrediente, fontSize = 16.sp)&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    item { Spacer(modifier = Modifier.height(16.dp)) }&#10;&#10;                    // Pasos&#10;                    item {&#10;                        Column(modifier = Modifier.padding(horizontal = 16.dp)) {&#10;                            Text(&#10;                                text = &quot;Preparación&quot;,&#10;                                fontSize = 20.sp,&#10;                                fontWeight = FontWeight.Bold,&#10;                                modifier = Modifier.padding(bottom = 8.dp)&#10;                            )&#10;                            receta.pasos.forEachIndexed { index, paso -&gt;&#10;                                Card(&#10;                                    modifier = Modifier&#10;                                        .fillMaxWidth()&#10;                                        .padding(vertical = 4.dp),&#10;                                    colors = CardDefaults.cardColors(&#10;                                        containerColor = MaterialTheme.colorScheme.surfaceVariant&#10;                                    )&#10;                                ) {&#10;                                    Row(&#10;                                        modifier = Modifier.padding(12.dp)&#10;                                    ) {&#10;                                        Box(&#10;                                            modifier = Modifier&#10;                                                .size(32.dp)&#10;                                                .clip(CircleShape)&#10;                                                .background(MaterialTheme.colorScheme.primary),&#10;                                            contentAlignment = Alignment.Center&#10;                                        ) {&#10;                                            Text(&#10;                                                text = &quot;${index + 1}&quot;,&#10;                                                color = MaterialTheme.colorScheme.onPrimary,&#10;                                                fontWeight = FontWeight.Bold&#10;                                            )&#10;                                        }&#10;                                        Spacer(modifier = Modifier.width(12.dp))&#10;                                        Text(&#10;                                            text = paso,&#10;                                            fontSize = 14.sp,&#10;                                            modifier = Modifier.weight(1f)&#10;                                        )&#10;                                    }&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    item { Spacer(modifier = Modifier.height(24.dp)) }&#10;                    item { HorizontalDivider(modifier = Modifier.padding(horizontal = 16.dp)) }&#10;                    item { Spacer(modifier = Modifier.height(16.dp)) }&#10;&#10;                    // Sección de comentarios&#10;                    item {&#10;                        Text(&#10;                            text = &quot;Comentarios (${uiState.comentarios.size})&quot;,&#10;                            fontSize = 20.sp,&#10;                            fontWeight = FontWeight.Bold,&#10;                            modifier = Modifier.padding(horizontal = 16.dp)&#10;                        )&#10;                    }&#10;&#10;                    item { Spacer(modifier = Modifier.height(8.dp)) }&#10;&#10;                    // Input de comentario&#10;                    item {&#10;                        var nuevoComentario by remember { mutableStateOf(&quot;&quot;) }&#10;                        var enviando by remember { mutableStateOf(false) }&#10;&#10;                        Row(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .padding(horizontal = 16.dp, vertical = 8.dp),&#10;                            verticalAlignment = Alignment.CenterVertically,&#10;                            horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                        ) {&#10;                            OutlinedTextField(&#10;                                value = nuevoComentario,&#10;                                onValueChange = { nuevoComentario = it },&#10;                                placeholder = { Text(&quot;Escribe un comentario...&quot;) },&#10;                                modifier = Modifier.weight(1f),&#10;                                maxLines = 3,&#10;                                enabled = !enviando&#10;                            )&#10;&#10;                            if (enviando) {&#10;                                CircularProgressIndicator(&#10;                                    modifier = Modifier.size(24.dp),&#10;                                    strokeWidth = 2.dp&#10;                                )&#10;                            } else {&#10;                                IconButton(&#10;                                    onClick = {&#10;                                        if (nuevoComentario.isNotBlank()) {&#10;                                            enviando = true&#10;                                            viewModel.agregarComentario(recetaId, nuevoComentario.trim())&#10;                                            nuevoComentario = &quot;&quot;&#10;                                            // Resetear estado después de delay&#10;                                            scope.launch {&#10;                                                kotlinx.coroutines.delay(1000)&#10;                                                enviando = false&#10;                                            }&#10;                                        }&#10;                                    },&#10;                                    enabled = nuevoComentario.isNotBlank()&#10;                                ) {&#10;                                    Icon(Icons.Default.Send, &quot;Enviar&quot;)&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    // Lista de comentarios&#10;                    items(&#10;                        items = uiState.comentarios,&#10;                        key = { it.id }&#10;                    ) { comentario -&gt;&#10;                        ComentarioItem(&#10;                            comentario = comentario,&#10;                            onResponder = { comentarioId -&gt;&#10;                                viewModel.seleccionarComentarioParaResponder(comentarioId)&#10;                            },&#10;                            onEliminar = {&#10;                                viewModel.eliminarComentario(it.id, recetaId)&#10;                            },&#10;                            onVerRespuestas = {&#10;                                viewModel.cargarRespuestas(comentario.id)&#10;                            },&#10;                            respuestas = uiState.respuestasPorComentario[comentario.id] ?: emptyList(),&#10;                            mostrarRespuestas = uiState.comentarioExpandido == comentario.id,&#10;                            viewModel = viewModel,&#10;                            recetaId = recetaId&#10;                        )&#10;                    }&#10;&#10;                    item { Spacer(modifier = Modifier.height(80.dp)) }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun InfoCard(icon: String, label: String, modifier: Modifier = Modifier) {&#10;    Card(&#10;        modifier = modifier,&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.secondaryContainer&#10;        )&#10;    ) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(12.dp),&#10;            horizontalAlignment = Alignment.CenterHorizontally&#10;        ) {&#10;            Text(icon, fontSize = 24.sp)&#10;            Spacer(modifier = Modifier.height(4.dp))&#10;            Text(&#10;                text = label,&#10;                fontSize = 12.sp,&#10;                fontWeight = FontWeight.Medium,&#10;                maxLines = 1,&#10;                overflow = TextOverflow.Ellipsis&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun ComentarioItem(&#10;    comentario: ComentarioReceta,&#10;    onResponder: (String) -&gt; Unit,&#10;    onEliminar: (ComentarioReceta) -&gt; Unit,&#10;    onVerRespuestas: () -&gt; Unit,&#10;    respuestas: List&lt;ComentarioReceta&gt;,&#10;    mostrarRespuestas: Boolean,&#10;    viewModel: DetalleRecetaComunidadViewModel,&#10;    recetaId: String&#10;) {&#10;    val currentUserId = FirebaseAuth.getInstance().currentUser?.uid&#10;    val esAutor = comentario.autorUid == currentUserId&#10;    var mostrarDialogoEliminar by remember { mutableStateOf(false) }&#10;    var mostrarInputRespuesta by remember { mutableStateOf(false) }&#10;    var textoRespuesta by remember { mutableStateOf(&quot;&quot;) }&#10;    var modoEdicion by remember { mutableStateOf(false) }&#10;    var textoEditado by remember { mutableStateOf(comentario.comentario) }&#10;&#10;    Column(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .padding(horizontal = 16.dp, vertical = 8.dp)&#10;    ) {&#10;        Card(&#10;            colors = CardDefaults.cardColors(&#10;                containerColor = MaterialTheme.colorScheme.surfaceVariant&#10;            )&#10;        ) {&#10;            Column(modifier = Modifier.padding(12.dp)) {&#10;                Row(&#10;                    verticalAlignment = Alignment.Top&#10;                ) {&#10;                    // Foto del autor&#10;                    if (comentario.autorFoto.isNotEmpty()) {&#10;                        AsyncImage(&#10;                            model = comentario.autorFoto,&#10;                            contentDescription = comentario.autorNombre,&#10;                            modifier = Modifier&#10;                                .size(36.dp)&#10;                                .clip(CircleShape),&#10;                            contentScale = ContentScale.Crop&#10;                        )&#10;                    } else {&#10;                        Box(&#10;                            modifier = Modifier&#10;                                .size(36.dp)&#10;                                .clip(CircleShape)&#10;                                .background(MaterialTheme.colorScheme.primary),&#10;                            contentAlignment = Alignment.Center&#10;                        ) {&#10;                            Text(&#10;                                text = comentario.autorNombre.firstOrNull()?.toString()?.uppercase() ?: &quot;?&quot;,&#10;                                color = MaterialTheme.colorScheme.onPrimary,&#10;                                fontWeight = FontWeight.Bold,&#10;                                fontSize = 14.sp&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.width(12.dp))&#10;&#10;                    Column(modifier = Modifier.weight(1f)) {&#10;                        Row(&#10;                            verticalAlignment = Alignment.CenterVertically,&#10;                            horizontalArrangement = Arrangement.SpaceBetween,&#10;                            modifier = Modifier.fillMaxWidth()&#10;                        ) {&#10;                            Text(&#10;                                text = comentario.autorNombre,&#10;                                fontWeight = FontWeight.Bold,&#10;                                fontSize = 14.sp&#10;                            )&#10;                            if (esAutor) {&#10;                                Row {&#10;                                    // Botón editar&#10;                                    IconButton(&#10;                                        onClick = {&#10;                                            modoEdicion = true&#10;                                            textoEditado = comentario.comentario&#10;                                        },&#10;                                        modifier = Modifier.size(24.dp)&#10;                                    ) {&#10;                                        Icon(&#10;                                            Icons.Default.Edit,&#10;                                            &quot;Editar&quot;,&#10;                                            tint = MaterialTheme.colorScheme.primary,&#10;                                            modifier = Modifier.size(18.dp)&#10;                                        )&#10;                                    }&#10;                                    // Botón eliminar&#10;                                    IconButton(&#10;                                        onClick = { mostrarDialogoEliminar = true },&#10;                                        modifier = Modifier.size(24.dp)&#10;                                    ) {&#10;                                        Icon(&#10;                                            Icons.Default.Delete,&#10;                                            &quot;Eliminar&quot;,&#10;                                            tint = MaterialTheme.colorScheme.error,&#10;                                            modifier = Modifier.size(18.dp)&#10;                                        )&#10;                                    }&#10;                                }&#10;                            }&#10;                        }&#10;&#10;                        Text(&#10;                            text = formatearFecha(comentario.fechaCreacion),&#10;                            fontSize = 11.sp,&#10;                            color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                        )&#10;&#10;                        Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                        // Modo edición o mostrar texto&#10;                        if (modoEdicion) {&#10;                            OutlinedTextField(&#10;                                value = textoEditado,&#10;                                onValueChange = { textoEditado = it },&#10;                                modifier = Modifier.fillMaxWidth(),&#10;                                maxLines = 5,&#10;                                placeholder = { Text(&quot;Editar comentario...&quot;) }&#10;                            )&#10;&#10;                            Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                            Row(&#10;                                horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                            ) {&#10;                                // Botón cancelar&#10;                                TextButton(onClick = {&#10;                                    modoEdicion = false&#10;                                    textoEditado = comentario.comentario&#10;                                }) {&#10;                                    Text(&quot;Cancelar&quot;)&#10;                                }&#10;&#10;                                // Botón guardar&#10;                                Button(&#10;                                    onClick = {&#10;                                        if (textoEditado.isNotBlank()) {&#10;                                            viewModel.editarComentario(&#10;                                                comentarioId = comentario.id,&#10;                                                nuevoTexto = textoEditado.trim(),&#10;                                                recetaId = recetaId,&#10;                                                parentId = comentario.parentId&#10;                                            )&#10;                                            modoEdicion = false&#10;                                        }&#10;                                    },&#10;                                    enabled = textoEditado.isNotBlank()&#10;                                ) {&#10;                                    Text(&quot;Guardar&quot;)&#10;                                }&#10;                            }&#10;                        } else {&#10;                            Text(&#10;                                text = comentario.comentario,&#10;                                fontSize = 14.sp&#10;                            )&#10;                        }&#10;&#10;                        Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                        // Botones de acción (solo si no está en modo edición)&#10;                        if (!modoEdicion) {&#10;                            Row(&#10;                                horizontalArrangement = Arrangement.spacedBy(16.dp)&#10;                            ) {&#10;                                TextButton(onClick = { mostrarInputRespuesta = !mostrarInputRespuesta }) {&#10;                                    Icon(Icons.Default.Reply, null, modifier = Modifier.size(16.dp))&#10;                                    Spacer(modifier = Modifier.width(4.dp))&#10;                                    Text(&quot;Responder&quot;, fontSize = 12.sp)&#10;                                }&#10;&#10;                                if (comentario.respuestas &gt; 0) {&#10;                                    TextButton(onClick = onVerRespuestas) {&#10;                                        Icon(&#10;                                            if (mostrarRespuestas) Icons.Default.ExpandLess else Icons.Default.ExpandMore,&#10;                                            null,&#10;                                            modifier = Modifier.size(16.dp)&#10;                                        )&#10;                                        Spacer(modifier = Modifier.width(4.dp))&#10;                                        Text(&quot;${comentario.respuestas} respuestas&quot;, fontSize = 12.sp)&#10;                                    }&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;&#10;                // Input para responder&#10;                if (mostrarInputRespuesta) {&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        verticalAlignment = Alignment.CenterVertically,&#10;                        horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                    ) {&#10;                        OutlinedTextField(&#10;                            value = textoRespuesta,&#10;                            onValueChange = { textoRespuesta = it },&#10;                            placeholder = { Text(&quot;Escribe una respuesta...&quot;, fontSize = 12.sp) },&#10;                            modifier = Modifier.weight(1f),&#10;                            maxLines = 2,&#10;                            textStyle = MaterialTheme.typography.bodySmall&#10;                        )&#10;                        IconButton(&#10;                            onClick = {&#10;                                if (textoRespuesta.isNotBlank()) {&#10;                                    viewModel.agregarRespuesta(recetaId, textoRespuesta, comentario.id)&#10;                                    textoRespuesta = &quot;&quot;&#10;                                    mostrarInputRespuesta = false&#10;                                }&#10;                            },&#10;                            enabled = textoRespuesta.isNotBlank()&#10;                        ) {&#10;                            Icon(Icons.Default.Send, &quot;Enviar&quot;, modifier = Modifier.size(20.dp))&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        // Respuestas&#10;        if (mostrarRespuestas &amp;&amp; respuestas.isNotEmpty()) {&#10;            Column(&#10;                modifier = Modifier.padding(start = 48.dp, top = 8.dp)&#10;            ) {&#10;                respuestas.forEach { respuesta -&gt;&#10;                    RespuestaItem(&#10;                        respuesta = respuesta,&#10;                        onEliminar = {&#10;                            viewModel.eliminarComentario(respuesta.id, recetaId)&#10;                        },&#10;                        viewModel = viewModel,&#10;                        recetaId = recetaId&#10;                    )&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    // Diálogo de confirmación para eliminar&#10;    if (mostrarDialogoEliminar) {&#10;        AlertDialog(&#10;            onDismissRequest = { mostrarDialogoEliminar = false },&#10;            title = { Text(&quot;Eliminar comentario&quot;) },&#10;            text = { Text(&quot;¿Estás seguro de que quieres eliminar este comentario?&quot;) },&#10;            confirmButton = {&#10;                TextButton(&#10;                    onClick = {&#10;                        mostrarDialogoEliminar = false&#10;                        onEliminar(comentario)&#10;                    },&#10;                    colors = ButtonDefaults.textButtonColors(&#10;                        contentColor = MaterialTheme.colorScheme.error&#10;                    )&#10;                ) {&#10;                    Text(&quot;Eliminar&quot;)&#10;                }&#10;            },&#10;            dismissButton = {&#10;                TextButton(onClick = { mostrarDialogoEliminar = false }) {&#10;                    Text(&quot;Cancelar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;fun RespuestaItem(&#10;    respuesta: ComentarioReceta,&#10;    onEliminar: () -&gt; Unit,&#10;    viewModel: DetalleRecetaComunidadViewModel,&#10;    recetaId: String&#10;) {&#10;    val currentUserId = FirebaseAuth.getInstance().currentUser?.uid&#10;    val esAutor = respuesta.autorUid == currentUserId&#10;    var mostrarDialogoEliminar by remember { mutableStateOf(false) }&#10;    var modoEdicion by remember { mutableStateOf(false) }&#10;    var textoEditado by remember { mutableStateOf(respuesta.comentario) }&#10;&#10;    Card(&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        ),&#10;        border = BorderStroke(1.dp, MaterialTheme.colorScheme.outline.copy(alpha = 0.3f))&#10;    ) {&#10;        Row(&#10;            modifier = Modifier.padding(12.dp),&#10;            verticalAlignment = Alignment.Top&#10;        ) {&#10;            // Foto del autor&#10;            if (respuesta.autorFoto.isNotEmpty()) {&#10;                AsyncImage(&#10;                    model = respuesta.autorFoto,&#10;                    contentDescription = respuesta.autorNombre,&#10;                    modifier = Modifier&#10;                        .size(28.dp)&#10;                        .clip(CircleShape),&#10;                    contentScale = ContentScale.Crop&#10;                )&#10;            } else {&#10;                Box(&#10;                    modifier = Modifier&#10;                        .size(28.dp)&#10;                        .clip(CircleShape)&#10;                        .background(MaterialTheme.colorScheme.primary),&#10;                    contentAlignment = Alignment.Center&#10;                ) {&#10;                    Text(&#10;                        text = respuesta.autorNombre.firstOrNull()?.toString()?.uppercase() ?: &quot;?&quot;,&#10;                        color = MaterialTheme.colorScheme.onPrimary,&#10;                        fontWeight = FontWeight.Bold,&#10;                        fontSize = 12.sp&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.width(8.dp))&#10;&#10;            Column(modifier = Modifier.weight(1f)) {&#10;                Row(&#10;                    verticalAlignment = Alignment.CenterVertically,&#10;                    horizontalArrangement = Arrangement.SpaceBetween,&#10;                    modifier = Modifier.fillMaxWidth()&#10;                ) {&#10;                    Column {&#10;                        Text(&#10;                            text = respuesta.autorNombre,&#10;                            fontWeight = FontWeight.Bold,&#10;                            fontSize = 13.sp&#10;                        )&#10;                        Text(&#10;                            text = formatearFecha(respuesta.fechaCreacion),&#10;                            fontSize = 10.sp,&#10;                            color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                        )&#10;                    }&#10;                    if (esAutor) {&#10;                        Row {&#10;                            // Botón editar&#10;                            IconButton(&#10;                                onClick = {&#10;                                    modoEdicion = true&#10;                                    textoEditado = respuesta.comentario&#10;                                },&#10;                                modifier = Modifier.size(20.dp)&#10;                            ) {&#10;                                Icon(&#10;                                    Icons.Default.Edit,&#10;                                    &quot;Editar&quot;,&#10;                                    tint = MaterialTheme.colorScheme.primary,&#10;                                    modifier = Modifier.size(16.dp)&#10;                                )&#10;                            }&#10;                            // Botón eliminar&#10;                            IconButton(&#10;                                onClick = { mostrarDialogoEliminar = true },&#10;                                modifier = Modifier.size(20.dp)&#10;                            ) {&#10;                                Icon(&#10;                                    Icons.Default.Delete,&#10;                                    &quot;Eliminar&quot;,&#10;                                    tint = MaterialTheme.colorScheme.error,&#10;                                    modifier = Modifier.size(16.dp)&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;&#10;                Spacer(modifier = Modifier.height(4.dp))&#10;&#10;                // Modo edición o mostrar texto&#10;                if (modoEdicion) {&#10;                    OutlinedTextField(&#10;                        value = textoEditado,&#10;                        onValueChange = { textoEditado = it },&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        maxLines = 5,&#10;                        placeholder = { Text(&quot;Editar respuesta...&quot;) },&#10;                        textStyle = MaterialTheme.typography.bodySmall&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                    Row(&#10;                        horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                    ) {&#10;                        // Botón cancelar&#10;                        TextButton(onClick = {&#10;                            modoEdicion = false&#10;                            textoEditado = respuesta.comentario&#10;                        }) {&#10;                            Text(&quot;Cancelar&quot;, fontSize = 11.sp)&#10;                        }&#10;&#10;                        // Botón guardar&#10;                        Button(&#10;                            onClick = {&#10;                                if (textoEditado.isNotBlank()) {&#10;                                    viewModel.editarComentario(&#10;                                        comentarioId = respuesta.id,&#10;                                        nuevoTexto = textoEditado.trim(),&#10;                                        recetaId = recetaId,&#10;                                        parentId = respuesta.parentId&#10;                                    )&#10;                                    modoEdicion = false&#10;                                }&#10;                            },&#10;                            enabled = textoEditado.isNotBlank()&#10;                        ) {&#10;                            Text(&quot;Guardar&quot;, fontSize = 11.sp)&#10;                        }&#10;                    }&#10;                } else {&#10;                    Text(&#10;                        text = respuesta.comentario,&#10;                        fontSize = 13.sp&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    // Diálogo de confirmación&#10;    if (mostrarDialogoEliminar) {&#10;        AlertDialog(&#10;            onDismissRequest = { mostrarDialogoEliminar = false },&#10;            title = { Text(&quot;Eliminar respuesta&quot;) },&#10;            text = { Text(&quot;¿Estás seguro de que quieres eliminar esta respuesta?&quot;) },&#10;            confirmButton = {&#10;                TextButton(&#10;                    onClick = {&#10;                        mostrarDialogoEliminar = false&#10;                        onEliminar()&#10;                    },&#10;                    colors = ButtonDefaults.textButtonColors(&#10;                        contentColor = MaterialTheme.colorScheme.error&#10;                    )&#10;                ) {&#10;                    Text(&quot;Eliminar&quot;)&#10;                }&#10;            },&#10;            dismissButton = {&#10;                TextButton(onClick = { mostrarDialogoEliminar = false }) {&#10;                    Text(&quot;Cancelar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.saborforaneo.ui.screens.community&#10;&#10;import android.content.Intent&#10;import androidx.compose.foundation.BorderStroke&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.lazy.rememberLazyListState&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextOverflow&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import androidx.lifecycle.viewmodel.compose.viewModel&#10;import coil.compose.AsyncImage&#10;import com.example.saborforaneo.data.model.ComentarioReceta&#10;import com.example.saborforaneo.viewmodel.DetalleRecetaComunidadViewModel&#10;import com.google.firebase.auth.FirebaseAuth&#10;import kotlinx.coroutines.launch&#10;import java.text.SimpleDateFormat&#10;import java.util.*&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun PantallaDetalleRecetaComunidad(&#10;    recetaId: String,&#10;    navegarAtras: () -&gt; Unit,&#10;    scrollToComments: Boolean = false,&#10;    viewModel: DetalleRecetaComunidadViewModel = viewModel()&#10;) {&#10;    val uiState by viewModel.uiState.collectAsState()&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    val scope = rememberCoroutineScope()&#10;    val listState = rememberLazyListState()&#10;    val contexto = LocalContext.current&#10;&#10;    LaunchedEffect(recetaId) {&#10;        viewModel.cargarReceta(recetaId)&#10;        viewModel.observarComentarios(recetaId)&#10;&#10;        // Si debe hacer scroll a comentarios, activar el flag&#10;        if (scrollToComments) {&#10;            viewModel.activarScrollAComentarios()&#10;        }&#10;    }&#10;&#10;    // Scroll automático a comentarios cuando se active el flag&#10;    LaunchedEffect(uiState.scrollToComments) {&#10;        if (uiState.scrollToComments) {&#10;            // Esperar un poco para que el contenido se renderice&#10;            kotlinx.coroutines.delay(300)&#10;            // Hacer scroll al índice donde empiezan los comentarios&#10;            // (aproximadamente después de imagen, info, ingredientes, pasos)&#10;            listState.animateScrollToItem(8) // Ajustar según la estructura&#10;            viewModel.desactivarScrollAComentarios()&#10;        }&#10;    }&#10;&#10;    LaunchedEffect(uiState.error) {&#10;        uiState.error?.let {&#10;            snackbarHostState.showSnackbar(it)&#10;            viewModel.limpiarError()&#10;        }&#10;    }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = { Text(&quot;Detalle de Receta&quot;, fontWeight = FontWeight.Bold) },&#10;                navigationIcon = {&#10;                    IconButton(onClick = navegarAtras) {&#10;                        Icon(Icons.Default.ArrowBack, &quot;Volver&quot;)&#10;                    }&#10;                },&#10;                actions = {&#10;                    IconButton(onClick = {&#10;                        uiState.receta?.let { receta -&gt;&#10;                            // Crear texto para compartir&#10;                            val textoCompartir = buildString {&#10;                                append(&quot; ${receta.nombre}\n\n&quot;)&#10;                                append(&quot; ${receta.descripcion}\n\n&quot;)&#10;                                append(&quot; Compartido por: ${receta.autorNombre}\n\n&quot;)&#10;                                append(&quot;⏱️ Tiempo: ${receta.tiempoPreparacion} min\n&quot;)&#10;                                append(&quot;️ Porciones: ${receta.porciones}\n&quot;)&#10;                                append(&quot; Dificultad: ${receta.dificultad.name}\n&quot;)&#10;                                append(&quot;️ Categoría: ${receta.categoria}\n\n&quot;)&#10;                                &#10;                                if (receta.ingredientes.isNotEmpty()) {&#10;                                    append(&quot; Ingredientes:\n&quot;)&#10;                                    receta.ingredientes.forEachIndexed { index, ingrediente -&gt;&#10;                                        append(&quot;${index + 1}. $ingrediente\n&quot;)&#10;                                    }&#10;                                    append(&quot;\n&quot;)&#10;                                }&#10;                                &#10;                                if (receta.pasos.isNotEmpty()) {&#10;                                    append(&quot;‍ Pasos:\n&quot;)&#10;                                    receta.pasos.forEachIndexed { index, paso -&gt;&#10;                                        append(&quot;${index + 1}. $paso\n&quot;)&#10;                                    }&#10;                                }&#10;                                &#10;                                append(&quot;\n ${receta.comentarios} comentarios&quot;)&#10;                                append(&quot;\n❤️ ${receta.likes} likes&quot;)&#10;                                append(&quot;\n\n¡Descubre más recetas en SaborForáneo! &quot;)&#10;                            }&#10;                            &#10;                            // Crear Intent para compartir&#10;                            val intentCompartir = Intent(Intent.ACTION_SEND).apply {&#10;                                type = &quot;text/plain&quot;&#10;                                putExtra(Intent.EXTRA_SUBJECT, &quot;Receta: ${receta.nombre}&quot;)&#10;                                putExtra(Intent.EXTRA_TEXT, textoCompartir)&#10;                            }&#10;                            &#10;                            // Mostrar selector de apps para compartir&#10;                            val chooser = Intent.createChooser(intentCompartir, &quot;Compartir receta vía...&quot;)&#10;                            contexto.startActivity(chooser)&#10;                        }&#10;                    }) {&#10;                        Icon(Icons.Default.Share, &quot;Compartir receta&quot;)&#10;                    }&#10;                }&#10;            )&#10;        },&#10;        snackbarHost = { SnackbarHost(snackbarHostState) }&#10;    ) { paddingValues -&gt;&#10;        if (uiState.cargando) {&#10;            Box(&#10;                modifier = Modifier&#10;                    .fillMaxSize()&#10;                    .padding(paddingValues),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        } else {&#10;            uiState.receta?.let { receta -&gt;&#10;                LazyColumn(&#10;                    state = listState,&#10;                    modifier = Modifier&#10;                        .fillMaxSize()&#10;                        .padding(paddingValues)&#10;                ) {&#10;                    // Imagen de la receta&#10;                    item {&#10;                        Box(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .height(300.dp)&#10;                                .background(MaterialTheme.colorScheme.surfaceVariant)&#10;                        ) {&#10;                            if (receta.imagenUrl.isNotEmpty()) {&#10;                                AsyncImage(&#10;                                    model = receta.imagenUrl,&#10;                                    contentDescription = receta.nombre,&#10;                                    modifier = Modifier.fillMaxSize(),&#10;                                    contentScale = ContentScale.Crop&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    // Información básica&#10;                    item {&#10;                        Column(&#10;                            modifier = Modifier.padding(16.dp)&#10;                        ) {&#10;                            // Autor&#10;                            Row(&#10;                                verticalAlignment = Alignment.CenterVertically,&#10;                                modifier = Modifier.padding(bottom = 12.dp)&#10;                            ) {&#10;                                if (receta.autorFoto.isNotEmpty()) {&#10;                                    AsyncImage(&#10;                                        model = receta.autorFoto,&#10;                                        contentDescription = receta.autorNombre,&#10;                                        modifier = Modifier&#10;                                            .size(40.dp)&#10;                                            .clip(CircleShape),&#10;                                        contentScale = ContentScale.Crop&#10;                                    )&#10;                                } else {&#10;                                    Box(&#10;                                        modifier = Modifier&#10;                                            .size(40.dp)&#10;                                            .clip(CircleShape)&#10;                                            .background(MaterialTheme.colorScheme.primaryContainer),&#10;                                        contentAlignment = Alignment.Center&#10;                                    ) {&#10;                                        Text(&#10;                                            text = receta.autorNombre.firstOrNull()?.toString()?.uppercase() ?: &quot;?&quot;,&#10;                                            fontWeight = FontWeight.Bold,&#10;                                            color = MaterialTheme.colorScheme.onPrimaryContainer&#10;                                        )&#10;                                    }&#10;                                }&#10;                                Spacer(modifier = Modifier.width(12.dp))&#10;                                Column {&#10;                                    Text(&#10;                                        text = receta.autorNombre,&#10;                                        fontWeight = FontWeight.Bold,&#10;                                        fontSize = 14.sp&#10;                                    )&#10;                                    Text(&#10;                                        text = formatearFecha(receta.fechaCreacion),&#10;                                        fontSize = 12.sp,&#10;                                        color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                                    )&#10;                                }&#10;                            }&#10;&#10;                            // Título&#10;                            Text(&#10;                                text = receta.nombre,&#10;                                fontSize = 24.sp,&#10;                                fontWeight = FontWeight.Bold&#10;                            )&#10;&#10;                            Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                            // Descripción&#10;                            Text(&#10;                                text = receta.descripcion,&#10;                                fontSize = 14.sp,&#10;                                color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                            )&#10;&#10;                            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                            // Info cards&#10;                            Row(&#10;                                modifier = Modifier.fillMaxWidth(),&#10;                                horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                            ) {&#10;                                InfoCard(&#10;                                    icon = &quot;⏱️&quot;,&#10;                                    label = &quot;${receta.tiempoPreparacion} min&quot;,&#10;                                    modifier = Modifier.weight(1f)&#10;                                )&#10;                                InfoCard(&#10;                                    icon = &quot;️&quot;,&#10;                                    label = &quot;${receta.porciones} porciones&quot;,&#10;                                    modifier = Modifier.weight(1f)&#10;                                )&#10;                                InfoCard(&#10;                                    icon = &quot;&quot;,&#10;                                    label = receta.dificultad.name,&#10;                                    modifier = Modifier.weight(1f)&#10;                                )&#10;                            }&#10;&#10;                            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                            // Likes y comentarios&#10;                            Row(&#10;                                modifier = Modifier.fillMaxWidth(),&#10;                                horizontalArrangement = Arrangement.spacedBy(16.dp)&#10;                            ) {&#10;                                val currentUserId = FirebaseAuth.getInstance().currentUser?.uid&#10;                                val leDioLike = receta.usuariosQueLikean.contains(currentUserId)&#10;&#10;                                Row(&#10;                                    verticalAlignment = Alignment.CenterVertically,&#10;                                    modifier = Modifier.clickable {&#10;                                        viewModel.toggleLike(recetaId)&#10;                                    }&#10;                                ) {&#10;                                    Icon(&#10;                                        imageVector = if (leDioLike) Icons.Filled.Favorite else Icons.Default.FavoriteBorder,&#10;                                        contentDescription = &quot;Like&quot;,&#10;                                        tint = if (leDioLike) MaterialTheme.colorScheme.error else MaterialTheme.colorScheme.onSurfaceVariant&#10;                                    )&#10;                                    Spacer(modifier = Modifier.width(4.dp))&#10;                                    Text(&#10;                                        text = &quot;${receta.likes}&quot;,&#10;                                        fontWeight = FontWeight.Medium&#10;                                    )&#10;                                }&#10;&#10;                                Row(&#10;                                    verticalAlignment = Alignment.CenterVertically&#10;                                ) {&#10;                                    Icon(&#10;                                        imageVector = Icons.Default.Comment,&#10;                                        contentDescription = &quot;Comentarios&quot;,&#10;                                        tint = MaterialTheme.colorScheme.onSurfaceVariant&#10;                                    )&#10;                                    Spacer(modifier = Modifier.width(4.dp))&#10;                                    Text(&#10;                                        text = &quot;${receta.comentarios}&quot;,&#10;                                        fontWeight = FontWeight.Medium&#10;                                    )&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    // Ingredientes&#10;                    item {&#10;                        Column(modifier = Modifier.padding(horizontal = 16.dp)) {&#10;                            Text(&#10;                                text = &quot;Ingredientes&quot;,&#10;                                fontSize = 20.sp,&#10;                                fontWeight = FontWeight.Bold,&#10;                                modifier = Modifier.padding(bottom = 8.dp)&#10;                            )&#10;                            receta.ingredientes.forEach { ingrediente -&gt;&#10;                                Row(&#10;                                    modifier = Modifier.padding(vertical = 4.dp)&#10;                                ) {&#10;                                    Text(&quot;• &quot;, fontSize = 16.sp)&#10;                                    Text(ingrediente, fontSize = 16.sp)&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    item { Spacer(modifier = Modifier.height(16.dp)) }&#10;&#10;                    // Pasos&#10;                    item {&#10;                        Column(modifier = Modifier.padding(horizontal = 16.dp)) {&#10;                            Text(&#10;                                text = &quot;Preparación&quot;,&#10;                                fontSize = 20.sp,&#10;                                fontWeight = FontWeight.Bold,&#10;                                modifier = Modifier.padding(bottom = 8.dp)&#10;                            )&#10;                            receta.pasos.forEachIndexed { index, paso -&gt;&#10;                                Card(&#10;                                    modifier = Modifier&#10;                                        .fillMaxWidth()&#10;                                        .padding(vertical = 4.dp),&#10;                                    colors = CardDefaults.cardColors(&#10;                                        containerColor = MaterialTheme.colorScheme.surfaceVariant&#10;                                    )&#10;                                ) {&#10;                                    Row(&#10;                                        modifier = Modifier.padding(12.dp)&#10;                                    ) {&#10;                                        Box(&#10;                                            modifier = Modifier&#10;                                                .size(32.dp)&#10;                                                .clip(CircleShape)&#10;                                                .background(MaterialTheme.colorScheme.primary),&#10;                                            contentAlignment = Alignment.Center&#10;                                        ) {&#10;                                            Text(&#10;                                                text = &quot;${index + 1}&quot;,&#10;                                                color = MaterialTheme.colorScheme.onPrimary,&#10;                                                fontWeight = FontWeight.Bold&#10;                                            )&#10;                                        }&#10;                                        Spacer(modifier = Modifier.width(12.dp))&#10;                                        Text(&#10;                                            text = paso,&#10;                                            fontSize = 14.sp,&#10;                                            modifier = Modifier.weight(1f)&#10;                                        )&#10;                                    }&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    item { Spacer(modifier = Modifier.height(24.dp)) }&#10;                    item { HorizontalDivider(modifier = Modifier.padding(horizontal = 16.dp)) }&#10;                    item { Spacer(modifier = Modifier.height(16.dp)) }&#10;&#10;                    // Sección de comentarios&#10;                    item {&#10;                        Text(&#10;                            text = &quot;Comentarios (${uiState.comentarios.size})&quot;,&#10;                            fontSize = 20.sp,&#10;                            fontWeight = FontWeight.Bold,&#10;                            modifier = Modifier.padding(horizontal = 16.dp)&#10;                        )&#10;                    }&#10;&#10;                    item { Spacer(modifier = Modifier.height(8.dp)) }&#10;&#10;                    // Input de comentario&#10;                    item {&#10;                        var nuevoComentario by remember { mutableStateOf(&quot;&quot;) }&#10;                        var enviando by remember { mutableStateOf(false) }&#10;&#10;                        Row(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .padding(horizontal = 16.dp, vertical = 8.dp),&#10;                            verticalAlignment = Alignment.CenterVertically,&#10;                            horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                        ) {&#10;                            OutlinedTextField(&#10;                                value = nuevoComentario,&#10;                                onValueChange = { nuevoComentario = it },&#10;                                placeholder = { Text(&quot;Escribe un comentario...&quot;) },&#10;                                modifier = Modifier.weight(1f),&#10;                                maxLines = 3,&#10;                                enabled = !enviando&#10;                            )&#10;&#10;                            if (enviando) {&#10;                                CircularProgressIndicator(&#10;                                    modifier = Modifier.size(24.dp),&#10;                                    strokeWidth = 2.dp&#10;                                )&#10;                            } else {&#10;                                IconButton(&#10;                                    onClick = {&#10;                                        if (nuevoComentario.isNotBlank()) {&#10;                                            enviando = true&#10;                                            viewModel.agregarComentario(recetaId, nuevoComentario.trim())&#10;                                            nuevoComentario = &quot;&quot;&#10;                                            // Resetear estado después de delay&#10;                                            scope.launch {&#10;                                                kotlinx.coroutines.delay(1000)&#10;                                                enviando = false&#10;                                            }&#10;                                        }&#10;                                    },&#10;                                    enabled = nuevoComentario.isNotBlank()&#10;                                ) {&#10;                                    Icon(Icons.Default.Send, &quot;Enviar&quot;)&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    // Lista de comentarios&#10;                    items(&#10;                        items = uiState.comentarios,&#10;                        key = { it.id }&#10;                    ) { comentario -&gt;&#10;                        ComentarioItem(&#10;                            comentario = comentario,&#10;                            onResponder = { comentarioId -&gt;&#10;                                viewModel.seleccionarComentarioParaResponder(comentarioId)&#10;                            },&#10;                            onEliminar = {&#10;                                viewModel.eliminarComentario(it.id, recetaId)&#10;                            },&#10;                            onVerRespuestas = {&#10;                                viewModel.cargarRespuestas(comentario.id)&#10;                            },&#10;                            respuestas = uiState.respuestasPorComentario[comentario.id] ?: emptyList(),&#10;                            mostrarRespuestas = uiState.comentarioExpandido == comentario.id,&#10;                            viewModel = viewModel,&#10;                            recetaId = recetaId&#10;                        )&#10;                    }&#10;&#10;                    item { Spacer(modifier = Modifier.height(80.dp)) }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun InfoCard(icon: String, label: String, modifier: Modifier = Modifier) {&#10;    Card(&#10;        modifier = modifier,&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.secondaryContainer&#10;        )&#10;    ) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(12.dp),&#10;            horizontalAlignment = Alignment.CenterHorizontally&#10;        ) {&#10;            Text(icon, fontSize = 24.sp)&#10;            Spacer(modifier = Modifier.height(4.dp))&#10;            Text(&#10;                text = label,&#10;                fontSize = 12.sp,&#10;                fontWeight = FontWeight.Medium,&#10;                maxLines = 1,&#10;                overflow = TextOverflow.Ellipsis&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun ComentarioItem(&#10;    comentario: ComentarioReceta,&#10;    onResponder: (String) -&gt; Unit,&#10;    onEliminar: (ComentarioReceta) -&gt; Unit,&#10;    onVerRespuestas: () -&gt; Unit,&#10;    respuestas: List&lt;ComentarioReceta&gt;,&#10;    mostrarRespuestas: Boolean,&#10;    viewModel: DetalleRecetaComunidadViewModel,&#10;    recetaId: String&#10;) {&#10;    val currentUserId = FirebaseAuth.getInstance().currentUser?.uid&#10;    val esAutor = comentario.autorUid == currentUserId&#10;    var mostrarDialogoEliminar by remember { mutableStateOf(false) }&#10;    var mostrarInputRespuesta by remember { mutableStateOf(false) }&#10;    var textoRespuesta by remember { mutableStateOf(&quot;&quot;) }&#10;    var modoEdicion by remember { mutableStateOf(false) }&#10;    var textoEditado by remember { mutableStateOf(comentario.comentario) }&#10;&#10;    Column(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .padding(horizontal = 16.dp, vertical = 8.dp)&#10;    ) {&#10;        Card(&#10;            colors = CardDefaults.cardColors(&#10;                containerColor = MaterialTheme.colorScheme.surfaceVariant&#10;            )&#10;        ) {&#10;            Column(modifier = Modifier.padding(12.dp)) {&#10;                Row(&#10;                    verticalAlignment = Alignment.Top&#10;                ) {&#10;                    // Foto del autor&#10;                    if (comentario.autorFoto.isNotEmpty()) {&#10;                        AsyncImage(&#10;                            model = comentario.autorFoto,&#10;                            contentDescription = comentario.autorNombre,&#10;                            modifier = Modifier&#10;                                .size(36.dp)&#10;                                .clip(CircleShape),&#10;                            contentScale = ContentScale.Crop&#10;                        )&#10;                    } else {&#10;                        Box(&#10;                            modifier = Modifier&#10;                                .size(36.dp)&#10;                                .clip(CircleShape)&#10;                                .background(MaterialTheme.colorScheme.primary),&#10;                            contentAlignment = Alignment.Center&#10;                        ) {&#10;                            Text(&#10;                                text = comentario.autorNombre.firstOrNull()?.toString()?.uppercase() ?: &quot;?&quot;,&#10;                                color = MaterialTheme.colorScheme.onPrimary,&#10;                                fontWeight = FontWeight.Bold,&#10;                                fontSize = 14.sp&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.width(12.dp))&#10;&#10;                    Column(modifier = Modifier.weight(1f)) {&#10;                        Row(&#10;                            verticalAlignment = Alignment.CenterVertically,&#10;                            horizontalArrangement = Arrangement.SpaceBetween,&#10;                            modifier = Modifier.fillMaxWidth()&#10;                        ) {&#10;                            Text(&#10;                                text = comentario.autorNombre,&#10;                                fontWeight = FontWeight.Bold,&#10;                                fontSize = 14.sp&#10;                            )&#10;                            if (esAutor) {&#10;                                Row {&#10;                                    // Botón editar&#10;                                    IconButton(&#10;                                        onClick = {&#10;                                            modoEdicion = true&#10;                                            textoEditado = comentario.comentario&#10;                                        },&#10;                                        modifier = Modifier.size(24.dp)&#10;                                    ) {&#10;                                        Icon(&#10;                                            Icons.Default.Edit,&#10;                                            &quot;Editar&quot;,&#10;                                            tint = MaterialTheme.colorScheme.primary,&#10;                                            modifier = Modifier.size(18.dp)&#10;                                        )&#10;                                    }&#10;                                    // Botón eliminar&#10;                                    IconButton(&#10;                                        onClick = { mostrarDialogoEliminar = true },&#10;                                        modifier = Modifier.size(24.dp)&#10;                                    ) {&#10;                                        Icon(&#10;                                            Icons.Default.Delete,&#10;                                            &quot;Eliminar&quot;,&#10;                                            tint = MaterialTheme.colorScheme.error,&#10;                                            modifier = Modifier.size(18.dp)&#10;                                        )&#10;                                    }&#10;                                }&#10;                            }&#10;                        }&#10;&#10;                        Text(&#10;                            text = formatearFecha(comentario.fechaCreacion),&#10;                            fontSize = 11.sp,&#10;                            color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                        )&#10;&#10;                        Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                        // Modo edición o mostrar texto&#10;                        if (modoEdicion) {&#10;                            OutlinedTextField(&#10;                                value = textoEditado,&#10;                                onValueChange = { textoEditado = it },&#10;                                modifier = Modifier.fillMaxWidth(),&#10;                                maxLines = 5,&#10;                                placeholder = { Text(&quot;Editar comentario...&quot;) }&#10;                            )&#10;&#10;                            Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                            Row(&#10;                                horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                            ) {&#10;                                // Botón cancelar&#10;                                TextButton(onClick = {&#10;                                    modoEdicion = false&#10;                                    textoEditado = comentario.comentario&#10;                                }) {&#10;                                    Text(&quot;Cancelar&quot;)&#10;                                }&#10;&#10;                                // Botón guardar&#10;                                Button(&#10;                                    onClick = {&#10;                                        if (textoEditado.isNotBlank()) {&#10;                                            viewModel.editarComentario(&#10;                                                comentarioId = comentario.id,&#10;                                                nuevoTexto = textoEditado.trim(),&#10;                                                recetaId = recetaId,&#10;                                                parentId = comentario.parentId&#10;                                            )&#10;                                            modoEdicion = false&#10;                                        }&#10;                                    },&#10;                                    enabled = textoEditado.isNotBlank()&#10;                                ) {&#10;                                    Text(&quot;Guardar&quot;)&#10;                                }&#10;                            }&#10;                        } else {&#10;                            Text(&#10;                                text = comentario.comentario,&#10;                                fontSize = 14.sp&#10;                            )&#10;                        }&#10;&#10;                        Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                        // Botones de acción (solo si no está en modo edición)&#10;                        if (!modoEdicion) {&#10;                            Row(&#10;                                horizontalArrangement = Arrangement.spacedBy(16.dp)&#10;                            ) {&#10;                                TextButton(onClick = { mostrarInputRespuesta = !mostrarInputRespuesta }) {&#10;                                    Icon(Icons.Default.Reply, null, modifier = Modifier.size(16.dp))&#10;                                    Spacer(modifier = Modifier.width(4.dp))&#10;                                    Text(&quot;Responder&quot;, fontSize = 12.sp)&#10;                                }&#10;&#10;                                if (comentario.respuestas &gt; 0) {&#10;                                    TextButton(onClick = onVerRespuestas) {&#10;                                        Icon(&#10;                                            if (mostrarRespuestas) Icons.Default.ExpandLess else Icons.Default.ExpandMore,&#10;                                            null,&#10;                                            modifier = Modifier.size(16.dp)&#10;                                        )&#10;                                        Spacer(modifier = Modifier.width(4.dp))&#10;                                        Text(&quot;${comentario.respuestas} respuestas&quot;, fontSize = 12.sp)&#10;                                    }&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;&#10;                // Input para responder&#10;                if (mostrarInputRespuesta) {&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        verticalAlignment = Alignment.CenterVertically,&#10;                        horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                    ) {&#10;                        OutlinedTextField(&#10;                            value = textoRespuesta,&#10;                            onValueChange = { textoRespuesta = it },&#10;                            placeholder = { Text(&quot;Escribe una respuesta...&quot;, fontSize = 12.sp) },&#10;                            modifier = Modifier.weight(1f),&#10;                            maxLines = 2,&#10;                            textStyle = MaterialTheme.typography.bodySmall&#10;                        )&#10;                        IconButton(&#10;                            onClick = {&#10;                                if (textoRespuesta.isNotBlank()) {&#10;                                    viewModel.agregarRespuesta(recetaId, textoRespuesta, comentario.id)&#10;                                    textoRespuesta = &quot;&quot;&#10;                                    mostrarInputRespuesta = false&#10;                                }&#10;                            },&#10;                            enabled = textoRespuesta.isNotBlank()&#10;                        ) {&#10;                            Icon(Icons.Default.Send, &quot;Enviar&quot;, modifier = Modifier.size(20.dp))&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        // Respuestas&#10;        if (mostrarRespuestas &amp;&amp; respuestas.isNotEmpty()) {&#10;            Column(&#10;                modifier = Modifier.padding(start = 48.dp, top = 8.dp)&#10;            ) {&#10;                respuestas.forEach { respuesta -&gt;&#10;                    RespuestaItem(&#10;                        respuesta = respuesta,&#10;                        onEliminar = {&#10;                            viewModel.eliminarComentario(respuesta.id, recetaId)&#10;                        },&#10;                        viewModel = viewModel,&#10;                        recetaId = recetaId&#10;                    )&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    // Diálogo de confirmación para eliminar&#10;    if (mostrarDialogoEliminar) {&#10;        AlertDialog(&#10;            onDismissRequest = { mostrarDialogoEliminar = false },&#10;            title = { Text(&quot;Eliminar comentario&quot;) },&#10;            text = { Text(&quot;¿Estás seguro de que quieres eliminar este comentario?&quot;) },&#10;            confirmButton = {&#10;                TextButton(&#10;                    onClick = {&#10;                        mostrarDialogoEliminar = false&#10;                        onEliminar(comentario)&#10;                    },&#10;                    colors = ButtonDefaults.textButtonColors(&#10;                        contentColor = MaterialTheme.colorScheme.error&#10;                    )&#10;                ) {&#10;                    Text(&quot;Eliminar&quot;)&#10;                }&#10;            },&#10;            dismissButton = {&#10;                TextButton(onClick = { mostrarDialogoEliminar = false }) {&#10;                    Text(&quot;Cancelar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;fun RespuestaItem(&#10;    respuesta: ComentarioReceta,&#10;    onEliminar: () -&gt; Unit,&#10;    viewModel: DetalleRecetaComunidadViewModel,&#10;    recetaId: String&#10;) {&#10;    val currentUserId = FirebaseAuth.getInstance().currentUser?.uid&#10;    val esAutor = respuesta.autorUid == currentUserId&#10;    var mostrarDialogoEliminar by remember { mutableStateOf(false) }&#10;    var modoEdicion by remember { mutableStateOf(false) }&#10;    var textoEditado by remember { mutableStateOf(respuesta.comentario) }&#10;&#10;    Card(&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        ),&#10;        border = BorderStroke(1.dp, MaterialTheme.colorScheme.outline.copy(alpha = 0.3f))&#10;    ) {&#10;        Row(&#10;            modifier = Modifier.padding(12.dp),&#10;            verticalAlignment = Alignment.Top&#10;        ) {&#10;            // Foto del autor&#10;            if (respuesta.autorFoto.isNotEmpty()) {&#10;                AsyncImage(&#10;                    model = respuesta.autorFoto,&#10;                    contentDescription = respuesta.autorNombre,&#10;                    modifier = Modifier&#10;                        .size(28.dp)&#10;                        .clip(CircleShape),&#10;                    contentScale = ContentScale.Crop&#10;                )&#10;            } else {&#10;                Box(&#10;                    modifier = Modifier&#10;                        .size(28.dp)&#10;                        .clip(CircleShape)&#10;                        .background(MaterialTheme.colorScheme.primary),&#10;                    contentAlignment = Alignment.Center&#10;                ) {&#10;                    Text(&#10;                        text = respuesta.autorNombre.firstOrNull()?.toString()?.uppercase() ?: &quot;?&quot;,&#10;                        color = MaterialTheme.colorScheme.onPrimary,&#10;                        fontWeight = FontWeight.Bold,&#10;                        fontSize = 12.sp&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.width(8.dp))&#10;&#10;            Column(modifier = Modifier.weight(1f)) {&#10;                Row(&#10;                    verticalAlignment = Alignment.CenterVertically,&#10;                    horizontalArrangement = Arrangement.SpaceBetween,&#10;                    modifier = Modifier.fillMaxWidth()&#10;                ) {&#10;                    Column {&#10;                        Text(&#10;                            text = respuesta.autorNombre,&#10;                            fontWeight = FontWeight.Bold,&#10;                            fontSize = 13.sp&#10;                        )&#10;                        Text(&#10;                            text = formatearFecha(respuesta.fechaCreacion),&#10;                            fontSize = 10.sp,&#10;                            color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                        )&#10;                    }&#10;                    if (esAutor) {&#10;                        Row {&#10;                            // Botón editar&#10;                            IconButton(&#10;                                onClick = {&#10;                                    modoEdicion = true&#10;                                    textoEditado = respuesta.comentario&#10;                                },&#10;                                modifier = Modifier.size(20.dp)&#10;                            ) {&#10;                                Icon(&#10;                                    Icons.Default.Edit,&#10;                                    &quot;Editar&quot;,&#10;                                    tint = MaterialTheme.colorScheme.primary,&#10;                                    modifier = Modifier.size(16.dp)&#10;                                )&#10;                            }&#10;                            // Botón eliminar&#10;                            IconButton(&#10;                                onClick = { mostrarDialogoEliminar = true },&#10;                                modifier = Modifier.size(20.dp)&#10;                            ) {&#10;                                Icon(&#10;                                    Icons.Default.Delete,&#10;                                    &quot;Eliminar&quot;,&#10;                                    tint = MaterialTheme.colorScheme.error,&#10;                                    modifier = Modifier.size(16.dp)&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;&#10;                Spacer(modifier = Modifier.height(4.dp))&#10;&#10;                // Modo edición o mostrar texto&#10;                if (modoEdicion) {&#10;                    OutlinedTextField(&#10;                        value = textoEditado,&#10;                        onValueChange = { textoEditado = it },&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        maxLines = 5,&#10;                        placeholder = { Text(&quot;Editar respuesta...&quot;) },&#10;                        textStyle = MaterialTheme.typography.bodySmall&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                    Row(&#10;                        horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                    ) {&#10;                        // Botón cancelar&#10;                        TextButton(onClick = {&#10;                            modoEdicion = false&#10;                            textoEditado = respuesta.comentario&#10;                        }) {&#10;                            Text(&quot;Cancelar&quot;, fontSize = 11.sp)&#10;                        }&#10;&#10;                        // Botón guardar&#10;                        Button(&#10;                            onClick = {&#10;                                if (textoEditado.isNotBlank()) {&#10;                                    viewModel.editarComentario(&#10;                                        comentarioId = respuesta.id,&#10;                                        nuevoTexto = textoEditado.trim(),&#10;                                        recetaId = recetaId,&#10;                                        parentId = respuesta.parentId&#10;                                    )&#10;                                    modoEdicion = false&#10;                                }&#10;                            },&#10;                            enabled = textoEditado.isNotBlank()&#10;                        ) {&#10;                            Text(&quot;Guardar&quot;, fontSize = 11.sp)&#10;                        }&#10;                    }&#10;                } else {&#10;                    Text(&#10;                        text = respuesta.comentario,&#10;                        fontSize = 13.sp&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    // Diálogo de confirmación&#10;    if (mostrarDialogoEliminar) {&#10;        AlertDialog(&#10;            onDismissRequest = { mostrarDialogoEliminar = false },&#10;            title = { Text(&quot;Eliminar respuesta&quot;) },&#10;            text = { Text(&quot;¿Estás seguro de que quieres eliminar esta respuesta?&quot;) },&#10;            confirmButton = {&#10;                TextButton(&#10;                    onClick = {&#10;                        mostrarDialogoEliminar = false&#10;                        onEliminar()&#10;                    },&#10;                    colors = ButtonDefaults.textButtonColors(&#10;                        contentColor = MaterialTheme.colorScheme.error&#10;                    )&#10;                ) {&#10;                    Text(&quot;Eliminar&quot;)&#10;                }&#10;            },&#10;            dismissButton = {&#10;                TextButton(onClick = { mostrarDialogoEliminar = false }) {&#10;                    Text(&quot;Cancelar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/ui/screens/detail/PantallaDetalleReceta.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/ui/screens/detail/PantallaDetalleReceta.kt" />
              <option name="originalContent" value="package com.example.saborforaneo.ui.screens.detail&#10;&#10;import androidx.compose.animation.*&#10;import androidx.compose.animation.core.*&#10;import androidx.compose.foundation.Image&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.ui.graphics.graphicsLayer&#10;import androidx.compose.foundation.lazy.itemsIndexed&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.res.painterResource&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import coil.compose.AsyncImage&#10;import com.example.saborforaneo.viewmodel.DetalleRecetaViewModel&#10;import kotlinx.coroutines.delay&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun PantallaDetalleReceta(&#10;    recetaId: String,&#10;    navegarAtras: () -&gt; Unit&#10;) {&#10;    val contexto = LocalContext.current&#10;    val viewModel = remember { DetalleRecetaViewModel(contexto, recetaId) }&#10;    val uiState by viewModel.uiState.collectAsState()&#10;&#10;    val receta = uiState.receta&#10;    var esFavorito by remember { mutableStateOf(receta?.esFavorito ?: false) }&#10;&#10;    val escalaImagen = remember { Animatable(0.8f) }&#10;    val alphaImagen = remember { Animatable(0f) }&#10;&#10;    LaunchedEffect(key1 = true) {&#10;        alphaImagen.animateTo(&#10;            targetValue = 1f,&#10;            animationSpec = tween(400)&#10;        )&#10;        escalaImagen.animateTo(&#10;            targetValue = 1f,&#10;            animationSpec = spring(&#10;                dampingRatio = Spring.DampingRatioMediumBouncy,&#10;                stiffness = Spring.StiffnessLow&#10;            )&#10;        )&#10;    }&#10;&#10;    if (uiState.cargando) {&#10;        // Mostrar pantalla de carga&#10;        Scaffold(&#10;            topBar = {&#10;                TopAppBar(&#10;                    title = { Text(&quot;Cargando...&quot;) },&#10;                    navigationIcon = {&#10;                        IconButton(onClick = navegarAtras) {&#10;                            Icon(&#10;                                imageVector = Icons.Default.ArrowBack,&#10;                                contentDescription = &quot;Volver&quot;&#10;                            )&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;        ) { paddingValues -&gt;&#10;            Box(&#10;                modifier = Modifier&#10;                    .fillMaxSize()&#10;                    .padding(paddingValues),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        }&#10;        return&#10;    }&#10;&#10;    if (receta == null || uiState.error != null) {&#10;        Scaffold(&#10;            topBar = {&#10;                TopAppBar(&#10;                    title = { Text(&quot;Error&quot;) },&#10;                    navigationIcon = {&#10;                        IconButton(onClick = navegarAtras) {&#10;                            Icon(&#10;                                imageVector = Icons.Default.ArrowBack,&#10;                                contentDescription = &quot;Volver&quot;&#10;                            )&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;        ) { paddingValues -&gt;&#10;            Box(&#10;                modifier = Modifier&#10;                    .fillMaxSize()&#10;                    .padding(paddingValues),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Column(&#10;                    horizontalAlignment = Alignment.CenterHorizontally&#10;                ) {&#10;                    Text(&#10;                        text = &quot;❌&quot;,&#10;                        fontSize = 64.sp&#10;                    )&#10;                    Spacer(modifier = Modifier.height(16.dp))&#10;                    Text(&#10;                        text = &quot;Receta no encontrada&quot;,&#10;                        fontSize = 18.sp,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;                    Button(onClick = navegarAtras) {&#10;                        Text(&quot;Volver al inicio&quot;)&#10;                    }&#10;                }&#10;            }&#10;        }&#10;        return&#10;    }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = { Text(&quot;&quot;) },&#10;                navigationIcon = {&#10;                    IconButton(onClick = navegarAtras) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.ArrowBack,&#10;                            contentDescription = &quot;Volver&quot;&#10;                        )&#10;                    }&#10;                },&#10;                actions = {&#10;                    IconButton(onClick = {&#10;                        esFavorito = !esFavorito&#10;                    }) {&#10;                        Icon(&#10;                            imageVector = if (esFavorito) Icons.Default.Favorite else Icons.Default.FavoriteBorder,&#10;                            contentDescription = if (esFavorito) &quot;Quitar de favoritos&quot; else &quot;Agregar a favoritos&quot;,&#10;                            tint = if (esFavorito) MaterialTheme.colorScheme.error else MaterialTheme.colorScheme.onSurface&#10;                        )&#10;                    }&#10;                    IconButton(onClick = { }) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.Share,&#10;                            contentDescription = &quot;Compartir&quot;&#10;                        )&#10;                    }&#10;                }&#10;            )&#10;        }&#10;    ) { paddingValues -&gt;&#10;        LazyColumn(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(paddingValues)&#10;        ) {&#10;            item {&#10;                Box(&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .height(280.dp)&#10;                        .graphicsLayer {&#10;                            scaleX = escalaImagen.value&#10;                            scaleY = escalaImagen.value&#10;                            alpha = alphaImagen.value&#10;                        }&#10;                ) {&#10;                    if (receta.imagenUrl.startsWith(&quot;http&quot;)) {&#10;                        AsyncImage(&#10;                            model = receta.imagenUrl,&#10;                            contentDescription = &quot;Imagen de ${receta.nombre}&quot;,&#10;                            modifier = Modifier.fillMaxSize(),&#10;                            contentScale = ContentScale.Crop&#10;                        )&#10;                    } else {&#10;                        val drawableId = contexto.resources.getIdentifier(&#10;                            receta.imagenUrl,&#10;                            &quot;drawable&quot;,&#10;                            contexto.packageName&#10;                        )&#10;&#10;                        if (drawableId != 0) {&#10;                            Image(&#10;                                painter = painterResource(id = drawableId),&#10;                                contentDescription = &quot;Imagen de ${receta.nombre}&quot;,&#10;                                modifier = Modifier.fillMaxSize(),&#10;                                contentScale = ContentScale.Crop&#10;                            )&#10;                        } else {&#10;                            Box(&#10;                                modifier = Modifier&#10;                                    .fillMaxSize()&#10;                                    .padding(32.dp),&#10;                                contentAlignment = Alignment.Center&#10;                            ) {&#10;                                Column(&#10;                                    horizontalAlignment = Alignment.CenterHorizontally&#10;                                ) {&#10;                                    Text(&#10;                                        text = &quot;️&quot;,&#10;                                        fontSize = 80.sp&#10;                                    )&#10;                                    Spacer(modifier = Modifier.height(8.dp))&#10;                                    Text(&#10;                                        text = &quot;Imagen no disponible&quot;,&#10;                                        fontSize = 14.sp,&#10;                                        color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;                                    )&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                Column(&#10;                    modifier = Modifier.padding(16.dp)&#10;                ) {&#10;                    Row(&#10;                        horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                    ) {&#10;                        Surface(&#10;                            shape = RoundedCornerShape(8.dp),&#10;                            color = MaterialTheme.colorScheme.primaryContainer&#10;                        ) {&#10;                            Text(&#10;                                text = receta.categoria,&#10;                                modifier = Modifier.padding(horizontal = 12.dp, vertical = 6.dp),&#10;                                fontSize = 12.sp,&#10;                                fontWeight = FontWeight.Bold,&#10;                                color = MaterialTheme.colorScheme.onPrimaryContainer&#10;                            )&#10;                        }&#10;&#10;                        Surface(&#10;                            shape = RoundedCornerShape(8.dp),&#10;                            color = MaterialTheme.colorScheme.secondaryContainer&#10;                        ) {&#10;                            Text(&#10;                                text = receta.pais,&#10;                                modifier = Modifier.padding(horizontal = 12.dp, vertical = 6.dp),&#10;                                fontSize = 12.sp,&#10;                                fontWeight = FontWeight.Bold,&#10;                                color = MaterialTheme.colorScheme.onSecondaryContainer&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.height(12.dp))&#10;&#10;                    Text(&#10;                        text = receta.nombre,&#10;                        fontSize = 28.sp,&#10;                        fontWeight = FontWeight.Bold,&#10;                        color = MaterialTheme.colorScheme.onSurface&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                    Text(&#10;                        text = receta.descripcion,&#10;                        fontSize = 16.sp,&#10;                        color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f),&#10;                        lineHeight = 24.sp&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(20.dp))&#10;&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.SpaceEvenly&#10;                    ) {&#10;                        InfoChip(&#10;                            icono = Icons.Default.AccessTime,&#10;                            texto = &quot;${receta.tiempoPreparacion} min&quot;,&#10;                            descripcion = &quot;Tiempo&quot;&#10;                        )&#10;&#10;                        InfoChip(&#10;                            icono = Icons.Default.Restaurant,&#10;                            texto = &quot;${receta.porciones}&quot;,&#10;                            descripcion = &quot;Porciones&quot;&#10;                        )&#10;&#10;                        InfoChip(&#10;                            icono = Icons.Default.TrendingUp,&#10;                            texto = when (receta.dificultad.name) {&#10;                                &quot;FACIL&quot; -&gt; &quot;Fácil&quot;&#10;                                &quot;MEDIA&quot; -&gt; &quot;Media&quot;&#10;                                else -&gt; &quot;Difícil&quot;&#10;                            },&#10;                            descripcion = &quot;Dificultad&quot;&#10;                        )&#10;&#10;                        InfoChip(&#10;                            icono = Icons.Default.AttachMoney,&#10;                            texto = when (receta.precio.name) {&#10;                                &quot;ECONOMICO&quot; -&gt; &quot;Bajo&quot;&#10;                                &quot;MODERADO&quot; -&gt; &quot;Medio&quot;&#10;                                else -&gt; &quot;Alto&quot;&#10;                            },&#10;                            descripcion = &quot;Costo&quot;&#10;                        )&#10;                    }&#10;&#10;                    if (receta.esVegetariana || receta.esVegana) {&#10;                        Spacer(modifier = Modifier.height(12.dp))&#10;                        Row(&#10;                            horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                        ) {&#10;                            if (receta.esVegetariana) {&#10;                                AssistChip(&#10;                                    onClick = { },&#10;                                    label = { Text(&quot; Vegetariana&quot;) }&#10;                                )&#10;                            }&#10;                            if (receta.esVegana) {&#10;                                AssistChip(&#10;                                    onClick = { },&#10;                                    label = { Text(&quot; Vegana&quot;) }&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                HorizontalDivider(modifier = Modifier.padding(vertical = 16.dp))&#10;            }&#10;&#10;            item {&#10;                Column(&#10;                    modifier = Modifier.padding(horizontal = 16.dp)&#10;                ) {&#10;                    Row(&#10;                        verticalAlignment = Alignment.CenterVertically,&#10;                        modifier = Modifier.padding(bottom = 12.dp)&#10;                    ) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.ShoppingCart,&#10;                            contentDescription = null,&#10;                            tint = MaterialTheme.colorScheme.primary,&#10;                            modifier = Modifier.size(28.dp)&#10;                        )&#10;                        Spacer(modifier = Modifier.width(12.dp))&#10;                        Text(&#10;                            text = &quot;Ingredientes&quot;,&#10;                            fontSize = 22.sp,&#10;                            fontWeight = FontWeight.Bold,&#10;                            color = MaterialTheme.colorScheme.primary&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            itemsIndexed(receta.ingredientes) { index, ingrediente -&gt;&#10;                IngredienteItemAnimado(ingrediente = ingrediente, index = index)&#10;            }&#10;&#10;            item {&#10;                HorizontalDivider(modifier = Modifier.padding(vertical = 16.dp))&#10;            }&#10;&#10;            item {&#10;                Column(&#10;                    modifier = Modifier.padding(horizontal = 16.dp)&#10;                ) {&#10;                    Row(&#10;                        verticalAlignment = Alignment.CenterVertically,&#10;                        modifier = Modifier.padding(bottom = 12.dp)&#10;                    ) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.MenuBook,&#10;                            contentDescription = null,&#10;                            tint = MaterialTheme.colorScheme.primary,&#10;                            modifier = Modifier.size(28.dp)&#10;                        )&#10;                        Spacer(modifier = Modifier.width(12.dp))&#10;                        Text(&#10;                            text = &quot;Preparación&quot;,&#10;                            fontSize = 22.sp,&#10;                            fontWeight = FontWeight.Bold,&#10;                            color = MaterialTheme.colorScheme.primary&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            itemsIndexed(receta.pasos) { index, paso -&gt;&#10;                PasoItemAnimado(numero = index + 1, paso = paso, index = index)&#10;            }&#10;&#10;            item {&#10;                Spacer(modifier = Modifier.height(32.dp))&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun InfoChip(&#10;    icono: androidx.compose.ui.graphics.vector.ImageVector,&#10;    texto: String,&#10;    descripcion: String&#10;) {&#10;    Column(&#10;        horizontalAlignment = Alignment.CenterHorizontally,&#10;        modifier = Modifier.width(80.dp)&#10;    ) {&#10;        Surface(&#10;            shape = RoundedCornerShape(12.dp),&#10;            color = MaterialTheme.colorScheme.secondaryContainer,&#10;            tonalElevation = 2.dp&#10;        ) {&#10;            Icon(&#10;                imageVector = icono,&#10;                contentDescription = descripcion,&#10;                modifier = Modifier.padding(12.dp),&#10;                tint = MaterialTheme.colorScheme.onSecondaryContainer&#10;            )&#10;        }&#10;        Spacer(modifier = Modifier.height(6.dp))&#10;        Text(&#10;            text = texto,&#10;            fontSize = 13.sp,&#10;            fontWeight = FontWeight.Bold,&#10;            color = MaterialTheme.colorScheme.onSurface&#10;        )&#10;        Text(&#10;            text = descripcion,&#10;            fontSize = 11.sp,&#10;            color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;        )&#10;    }&#10;}&#10;&#10;&#10;@Composable&#10;fun IngredienteItemAnimado(ingrediente: String, index: Int) {&#10;    var marcado by remember { mutableStateOf(false) }&#10;    var visible by remember { mutableStateOf(false) }&#10;&#10;    LaunchedEffect(key1 = ingrediente) {&#10;        delay(index * 30L)&#10;        visible = true&#10;    }&#10;&#10;    AnimatedVisibility(&#10;        visible = visible,&#10;        enter = fadeIn(&#10;            animationSpec = tween(&#10;                durationMillis = 250,&#10;                easing = FastOutSlowInEasing&#10;            )&#10;        ) + slideInHorizontally(&#10;            initialOffsetX = { -it / 3 },&#10;            animationSpec = tween(&#10;                durationMillis = 250,&#10;                easing = FastOutSlowInEasing&#10;            )&#10;        )&#10;    ) {&#10;        Surface(&#10;            onClick = { marcado = !marcado },&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(horizontal = 16.dp, vertical = 4.dp),&#10;            shape = RoundedCornerShape(8.dp),&#10;            color = if (marcado)&#10;                MaterialTheme.colorScheme.tertiaryContainer.copy(alpha = 0.3f)&#10;            else&#10;                MaterialTheme.colorScheme.surface&#10;        ) {&#10;            Row(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .padding(horizontal = 12.dp, vertical = 12.dp),&#10;                verticalAlignment = Alignment.CenterVertically&#10;            ) {&#10;                Icon(&#10;                    imageVector = if (marcado) Icons.Default.CheckCircle else Icons.Default.Circle,&#10;                    contentDescription = null,&#10;                    tint = if (marcado)&#10;                        MaterialTheme.colorScheme.tertiary&#10;                    else&#10;                        MaterialTheme.colorScheme.outline,&#10;                    modifier = Modifier.size(22.dp)&#10;                )&#10;                Spacer(modifier = Modifier.width(12.dp))&#10;                Text(&#10;                    text = ingrediente,&#10;                    fontSize = 15.sp,&#10;                    color = if (marcado)&#10;                        MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;                    else&#10;                        MaterialTheme.colorScheme.onSurface&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun PasoItemAnimado(numero: Int, paso: String, index: Int) {&#10;    var visible by remember { mutableStateOf(false) }&#10;&#10;    LaunchedEffect(key1 = paso) {&#10;        delay(index * 40L)&#10;        visible = true&#10;    }&#10;&#10;    AnimatedVisibility(&#10;        visible = visible,&#10;        enter = fadeIn(&#10;            animationSpec = tween(&#10;                durationMillis = 280,&#10;                easing = FastOutSlowInEasing&#10;            )&#10;        ) + slideInHorizontally(&#10;            initialOffsetX = { it / 3 },&#10;            animationSpec = tween(&#10;                durationMillis = 280,&#10;                easing = FastOutSlowInEasing&#10;            )&#10;        )&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(horizontal = 16.dp, vertical = 12.dp)&#10;        ) {&#10;            Surface(&#10;                shape = RoundedCornerShape(50),&#10;                color = MaterialTheme.colorScheme.primary,&#10;                modifier = Modifier.size(36.dp),&#10;                tonalElevation = 4.dp&#10;            ) {&#10;                Box(&#10;                    contentAlignment = Alignment.Center&#10;                ) {&#10;                    Text(&#10;                        text = numero.toString(),&#10;                        color = MaterialTheme.colorScheme.onPrimary,&#10;                        fontWeight = FontWeight.Bold,&#10;                        fontSize = 16.sp&#10;                    )&#10;                }&#10;            }&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;            Text(&#10;                text = paso,&#10;                fontSize = 15.sp,&#10;                lineHeight = 22.sp,&#10;                modifier = Modifier.weight(1f),&#10;                color = MaterialTheme.colorScheme.onSurface&#10;            )&#10;        }&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.saborforaneo.ui.screens.detail&#10;&#10;import android.content.Intent&#10;import androidx.compose.animation.*&#10;import androidx.compose.animation.core.*&#10;import androidx.compose.foundation.Image&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.ui.graphics.graphicsLayer&#10;import androidx.compose.foundation.lazy.itemsIndexed&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.res.painterResource&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import coil.compose.AsyncImage&#10;import com.example.saborforaneo.viewmodel.DetalleRecetaViewModel&#10;import kotlinx.coroutines.delay&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun PantallaDetalleReceta(&#10;    recetaId: String,&#10;    navegarAtras: () -&gt; Unit&#10;) {&#10;    val contexto = LocalContext.current&#10;    val viewModel = remember { DetalleRecetaViewModel(contexto, recetaId) }&#10;    val uiState by viewModel.uiState.collectAsState()&#10;&#10;    val receta = uiState.receta&#10;    var esFavorito by remember { mutableStateOf(receta?.esFavorito ?: false) }&#10;&#10;    val escalaImagen = remember { Animatable(0.8f) }&#10;    val alphaImagen = remember { Animatable(0f) }&#10;&#10;    LaunchedEffect(key1 = true) {&#10;        alphaImagen.animateTo(&#10;            targetValue = 1f,&#10;            animationSpec = tween(400)&#10;        )&#10;        escalaImagen.animateTo(&#10;            targetValue = 1f,&#10;            animationSpec = spring(&#10;                dampingRatio = Spring.DampingRatioMediumBouncy,&#10;                stiffness = Spring.StiffnessLow&#10;            )&#10;        )&#10;    }&#10;&#10;    if (uiState.cargando) {&#10;        // Mostrar pantalla de carga&#10;        Scaffold(&#10;            topBar = {&#10;                TopAppBar(&#10;                    title = { Text(&quot;Cargando...&quot;) },&#10;                    navigationIcon = {&#10;                        IconButton(onClick = navegarAtras) {&#10;                            Icon(&#10;                                imageVector = Icons.Default.ArrowBack,&#10;                                contentDescription = &quot;Volver&quot;&#10;                            )&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;        ) { paddingValues -&gt;&#10;            Box(&#10;                modifier = Modifier&#10;                    .fillMaxSize()&#10;                    .padding(paddingValues),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        }&#10;        return&#10;    }&#10;&#10;    if (receta == null || uiState.error != null) {&#10;        Scaffold(&#10;            topBar = {&#10;                TopAppBar(&#10;                    title = { Text(&quot;Error&quot;) },&#10;                    navigationIcon = {&#10;                        IconButton(onClick = navegarAtras) {&#10;                            Icon(&#10;                                imageVector = Icons.Default.ArrowBack,&#10;                                contentDescription = &quot;Volver&quot;&#10;                            )&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;        ) { paddingValues -&gt;&#10;            Box(&#10;                modifier = Modifier&#10;                    .fillMaxSize()&#10;                    .padding(paddingValues),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Column(&#10;                    horizontalAlignment = Alignment.CenterHorizontally&#10;                ) {&#10;                    Text(&#10;                        text = &quot;❌&quot;,&#10;                        fontSize = 64.sp&#10;                    )&#10;                    Spacer(modifier = Modifier.height(16.dp))&#10;                    Text(&#10;                        text = &quot;Receta no encontrada&quot;,&#10;                        fontSize = 18.sp,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;                    Button(onClick = navegarAtras) {&#10;                        Text(&quot;Volver al inicio&quot;)&#10;                    }&#10;                }&#10;            }&#10;        }&#10;        return&#10;    }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = { Text(&quot;&quot;) },&#10;                navigationIcon = {&#10;                    IconButton(onClick = navegarAtras) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.ArrowBack,&#10;                            contentDescription = &quot;Volver&quot;&#10;                        )&#10;                    }&#10;                },&#10;                actions = {&#10;                    IconButton(onClick = {&#10;                        esFavorito = !esFavorito&#10;                    }) {&#10;                        Icon(&#10;                            imageVector = if (esFavorito) Icons.Default.Favorite else Icons.Default.FavoriteBorder,&#10;                            contentDescription = if (esFavorito) &quot;Quitar de favoritos&quot; else &quot;Agregar a favoritos&quot;,&#10;                            tint = if (esFavorito) MaterialTheme.colorScheme.error else MaterialTheme.colorScheme.onSurface&#10;                        )&#10;                    }&#10;                    IconButton(onClick = {&#10;                        receta?.let { recetaActual -&gt;&#10;                            // Crear texto para compartir&#10;                            val textoCompartir = buildString {&#10;                                append(&quot; ${recetaActual.nombre}\n\n&quot;)&#10;                                append(&quot; ${recetaActual.descripcion}\n\n&quot;)&#10;                                append(&quot;⏱️ Tiempo: ${recetaActual.tiempoPreparacion} min\n&quot;)&#10;                                append(&quot;️ Porciones: ${recetaActual.porciones}\n&quot;)&#10;                                append(&quot; Dificultad: ${recetaActual.dificultad.name}\n\n&quot;)&#10;                                &#10;                                if (recetaActual.ingredientes.isNotEmpty()) {&#10;                                    append(&quot; Ingredientes:\n&quot;)&#10;                                    recetaActual.ingredientes.forEachIndexed { index, ingrediente -&gt;&#10;                                        append(&quot;${index + 1}. $ingrediente\n&quot;)&#10;                                    }&#10;                                    append(&quot;\n&quot;)&#10;                                }&#10;                                &#10;                                if (recetaActual.pasos.isNotEmpty()) {&#10;                                    append(&quot;‍ Pasos:\n&quot;)&#10;                                    recetaActual.pasos.forEachIndexed { index, paso -&gt;&#10;                                        append(&quot;${index + 1}. $paso\n&quot;)&#10;                                    }&#10;                                }&#10;                                &#10;                                append(&quot;\n¡Comparte esta deliciosa receta de SaborForáneo! &quot;)&#10;                            }&#10;                            &#10;                            // Crear Intent para compartir&#10;                            val intentCompartir = Intent(Intent.ACTION_SEND).apply {&#10;                                type = &quot;text/plain&quot;&#10;                                putExtra(Intent.EXTRA_SUBJECT, &quot;Receta: ${recetaActual.nombre}&quot;)&#10;                                putExtra(Intent.EXTRA_TEXT, textoCompartir)&#10;                            }&#10;                            &#10;                            // Mostrar selector de apps para compartir&#10;                            val chooser = Intent.createChooser(intentCompartir, &quot;Compartir receta vía...&quot;)&#10;                            contexto.startActivity(chooser)&#10;                        }&#10;                    }) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.Share,&#10;                            contentDescription = &quot;Compartir&quot;&#10;                        )&#10;                    }&#10;                }&#10;            )&#10;        }&#10;    ) { paddingValues -&gt;&#10;        LazyColumn(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(paddingValues)&#10;        ) {&#10;            item {&#10;                Box(&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .height(280.dp)&#10;                        .graphicsLayer {&#10;                            scaleX = escalaImagen.value&#10;                            scaleY = escalaImagen.value&#10;                            alpha = alphaImagen.value&#10;                        }&#10;                ) {&#10;                    if (receta.imagenUrl.startsWith(&quot;http&quot;)) {&#10;                        AsyncImage(&#10;                            model = receta.imagenUrl,&#10;                            contentDescription = &quot;Imagen de ${receta.nombre}&quot;,&#10;                            modifier = Modifier.fillMaxSize(),&#10;                            contentScale = ContentScale.Crop&#10;                        )&#10;                    } else {&#10;                        val drawableId = contexto.resources.getIdentifier(&#10;                            receta.imagenUrl,&#10;                            &quot;drawable&quot;,&#10;                            contexto.packageName&#10;                        )&#10;&#10;                        if (drawableId != 0) {&#10;                            Image(&#10;                                painter = painterResource(id = drawableId),&#10;                                contentDescription = &quot;Imagen de ${receta.nombre}&quot;,&#10;                                modifier = Modifier.fillMaxSize(),&#10;                                contentScale = ContentScale.Crop&#10;                            )&#10;                        } else {&#10;                            Box(&#10;                                modifier = Modifier&#10;                                    .fillMaxSize()&#10;                                    .padding(32.dp),&#10;                                contentAlignment = Alignment.Center&#10;                            ) {&#10;                                Column(&#10;                                    horizontalAlignment = Alignment.CenterHorizontally&#10;                                ) {&#10;                                    Text(&#10;                                        text = &quot;️&quot;,&#10;                                        fontSize = 80.sp&#10;                                    )&#10;                                    Spacer(modifier = Modifier.height(8.dp))&#10;                                    Text(&#10;                                        text = &quot;Imagen no disponible&quot;,&#10;                                        fontSize = 14.sp,&#10;                                        color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;                                    )&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                Column(&#10;                    modifier = Modifier.padding(16.dp)&#10;                ) {&#10;                    Row(&#10;                        horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                    ) {&#10;                        Surface(&#10;                            shape = RoundedCornerShape(8.dp),&#10;                            color = MaterialTheme.colorScheme.primaryContainer&#10;                        ) {&#10;                            Text(&#10;                                text = receta.categoria,&#10;                                modifier = Modifier.padding(horizontal = 12.dp, vertical = 6.dp),&#10;                                fontSize = 12.sp,&#10;                                fontWeight = FontWeight.Bold,&#10;                                color = MaterialTheme.colorScheme.onPrimaryContainer&#10;                            )&#10;                        }&#10;&#10;                        Surface(&#10;                            shape = RoundedCornerShape(8.dp),&#10;                            color = MaterialTheme.colorScheme.secondaryContainer&#10;                        ) {&#10;                            Text(&#10;                                text = receta.pais,&#10;                                modifier = Modifier.padding(horizontal = 12.dp, vertical = 6.dp),&#10;                                fontSize = 12.sp,&#10;                                fontWeight = FontWeight.Bold,&#10;                                color = MaterialTheme.colorScheme.onSecondaryContainer&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.height(12.dp))&#10;&#10;                    Text(&#10;                        text = receta.nombre,&#10;                        fontSize = 28.sp,&#10;                        fontWeight = FontWeight.Bold,&#10;                        color = MaterialTheme.colorScheme.onSurface&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                    Text(&#10;                        text = receta.descripcion,&#10;                        fontSize = 16.sp,&#10;                        color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f),&#10;                        lineHeight = 24.sp&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(20.dp))&#10;&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.SpaceEvenly&#10;                    ) {&#10;                        InfoChip(&#10;                            icono = Icons.Default.AccessTime,&#10;                            texto = &quot;${receta.tiempoPreparacion} min&quot;,&#10;                            descripcion = &quot;Tiempo&quot;&#10;                        )&#10;&#10;                        InfoChip(&#10;                            icono = Icons.Default.Restaurant,&#10;                            texto = &quot;${receta.porciones}&quot;,&#10;                            descripcion = &quot;Porciones&quot;&#10;                        )&#10;&#10;                        InfoChip(&#10;                            icono = Icons.Default.TrendingUp,&#10;                            texto = when (receta.dificultad.name) {&#10;                                &quot;FACIL&quot; -&gt; &quot;Fácil&quot;&#10;                                &quot;MEDIA&quot; -&gt; &quot;Media&quot;&#10;                                else -&gt; &quot;Difícil&quot;&#10;                            },&#10;                            descripcion = &quot;Dificultad&quot;&#10;                        )&#10;&#10;                        InfoChip(&#10;                            icono = Icons.Default.AttachMoney,&#10;                            texto = when (receta.precio.name) {&#10;                                &quot;ECONOMICO&quot; -&gt; &quot;Bajo&quot;&#10;                                &quot;MODERADO&quot; -&gt; &quot;Medio&quot;&#10;                                else -&gt; &quot;Alto&quot;&#10;                            },&#10;                            descripcion = &quot;Costo&quot;&#10;                        )&#10;                    }&#10;&#10;                    if (receta.esVegetariana || receta.esVegana) {&#10;                        Spacer(modifier = Modifier.height(12.dp))&#10;                        Row(&#10;                            horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                        ) {&#10;                            if (receta.esVegetariana) {&#10;                                AssistChip(&#10;                                    onClick = { },&#10;                                    label = { Text(&quot; Vegetariana&quot;) }&#10;                                )&#10;                            }&#10;                            if (receta.esVegana) {&#10;                                AssistChip(&#10;                                    onClick = { },&#10;                                    label = { Text(&quot; Vegana&quot;) }&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                HorizontalDivider(modifier = Modifier.padding(vertical = 16.dp))&#10;            }&#10;&#10;            item {&#10;                Column(&#10;                    modifier = Modifier.padding(horizontal = 16.dp)&#10;                ) {&#10;                    Row(&#10;                        verticalAlignment = Alignment.CenterVertically,&#10;                        modifier = Modifier.padding(bottom = 12.dp)&#10;                    ) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.ShoppingCart,&#10;                            contentDescription = null,&#10;                            tint = MaterialTheme.colorScheme.primary,&#10;                            modifier = Modifier.size(28.dp)&#10;                        )&#10;                        Spacer(modifier = Modifier.width(12.dp))&#10;                        Text(&#10;                            text = &quot;Ingredientes&quot;,&#10;                            fontSize = 22.sp,&#10;                            fontWeight = FontWeight.Bold,&#10;                            color = MaterialTheme.colorScheme.primary&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            itemsIndexed(receta.ingredientes) { index, ingrediente -&gt;&#10;                IngredienteItemAnimado(ingrediente = ingrediente, index = index)&#10;            }&#10;&#10;            item {&#10;                HorizontalDivider(modifier = Modifier.padding(vertical = 16.dp))&#10;            }&#10;&#10;            item {&#10;                Column(&#10;                    modifier = Modifier.padding(horizontal = 16.dp)&#10;                ) {&#10;                    Row(&#10;                        verticalAlignment = Alignment.CenterVertically,&#10;                        modifier = Modifier.padding(bottom = 12.dp)&#10;                    ) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.MenuBook,&#10;                            contentDescription = null,&#10;                            tint = MaterialTheme.colorScheme.primary,&#10;                            modifier = Modifier.size(28.dp)&#10;                        )&#10;                        Spacer(modifier = Modifier.width(12.dp))&#10;                        Text(&#10;                            text = &quot;Preparación&quot;,&#10;                            fontSize = 22.sp,&#10;                            fontWeight = FontWeight.Bold,&#10;                            color = MaterialTheme.colorScheme.primary&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            itemsIndexed(receta.pasos) { index, paso -&gt;&#10;                PasoItemAnimado(numero = index + 1, paso = paso, index = index)&#10;            }&#10;&#10;            item {&#10;                Spacer(modifier = Modifier.height(32.dp))&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun InfoChip(&#10;    icono: androidx.compose.ui.graphics.vector.ImageVector,&#10;    texto: String,&#10;    descripcion: String&#10;) {&#10;    Column(&#10;        horizontalAlignment = Alignment.CenterHorizontally,&#10;        modifier = Modifier.width(80.dp)&#10;    ) {&#10;        Surface(&#10;            shape = RoundedCornerShape(12.dp),&#10;            color = MaterialTheme.colorScheme.secondaryContainer,&#10;            tonalElevation = 2.dp&#10;        ) {&#10;            Icon(&#10;                imageVector = icono,&#10;                contentDescription = descripcion,&#10;                modifier = Modifier.padding(12.dp),&#10;                tint = MaterialTheme.colorScheme.onSecondaryContainer&#10;            )&#10;        }&#10;        Spacer(modifier = Modifier.height(6.dp))&#10;        Text(&#10;            text = texto,&#10;            fontSize = 13.sp,&#10;            fontWeight = FontWeight.Bold,&#10;            color = MaterialTheme.colorScheme.onSurface&#10;        )&#10;        Text(&#10;            text = descripcion,&#10;            fontSize = 11.sp,&#10;            color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;        )&#10;    }&#10;}&#10;&#10;&#10;@Composable&#10;fun IngredienteItemAnimado(ingrediente: String, index: Int) {&#10;    var marcado by remember { mutableStateOf(false) }&#10;    var visible by remember { mutableStateOf(false) }&#10;&#10;    LaunchedEffect(key1 = ingrediente) {&#10;        delay(index * 30L)&#10;        visible = true&#10;    }&#10;&#10;    AnimatedVisibility(&#10;        visible = visible,&#10;        enter = fadeIn(&#10;            animationSpec = tween(&#10;                durationMillis = 250,&#10;                easing = FastOutSlowInEasing&#10;            )&#10;        ) + slideInHorizontally(&#10;            initialOffsetX = { -it / 3 },&#10;            animationSpec = tween(&#10;                durationMillis = 250,&#10;                easing = FastOutSlowInEasing&#10;            )&#10;        )&#10;    ) {&#10;        Surface(&#10;            onClick = { marcado = !marcado },&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(horizontal = 16.dp, vertical = 4.dp),&#10;            shape = RoundedCornerShape(8.dp),&#10;            color = if (marcado)&#10;                MaterialTheme.colorScheme.tertiaryContainer.copy(alpha = 0.3f)&#10;            else&#10;                MaterialTheme.colorScheme.surface&#10;        ) {&#10;            Row(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .padding(horizontal = 12.dp, vertical = 12.dp),&#10;                verticalAlignment = Alignment.CenterVertically&#10;            ) {&#10;                Icon(&#10;                    imageVector = if (marcado) Icons.Default.CheckCircle else Icons.Default.Circle,&#10;                    contentDescription = null,&#10;                    tint = if (marcado)&#10;                        MaterialTheme.colorScheme.tertiary&#10;                    else&#10;                        MaterialTheme.colorScheme.outline,&#10;                    modifier = Modifier.size(22.dp)&#10;                )&#10;                Spacer(modifier = Modifier.width(12.dp))&#10;                Text(&#10;                    text = ingrediente,&#10;                    fontSize = 15.sp,&#10;                    color = if (marcado)&#10;                        MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;                    else&#10;                        MaterialTheme.colorScheme.onSurface&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun PasoItemAnimado(numero: Int, paso: String, index: Int) {&#10;    var visible by remember { mutableStateOf(false) }&#10;&#10;    LaunchedEffect(key1 = paso) {&#10;        delay(index * 40L)&#10;        visible = true&#10;    }&#10;&#10;    AnimatedVisibility(&#10;        visible = visible,&#10;        enter = fadeIn(&#10;            animationSpec = tween(&#10;                durationMillis = 280,&#10;                easing = FastOutSlowInEasing&#10;            )&#10;        ) + slideInHorizontally(&#10;            initialOffsetX = { it / 3 },&#10;            animationSpec = tween(&#10;                durationMillis = 280,&#10;                easing = FastOutSlowInEasing&#10;            )&#10;        )&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(horizontal = 16.dp, vertical = 12.dp)&#10;        ) {&#10;            Surface(&#10;                shape = RoundedCornerShape(50),&#10;                color = MaterialTheme.colorScheme.primary,&#10;                modifier = Modifier.size(36.dp),&#10;                tonalElevation = 4.dp&#10;            ) {&#10;                Box(&#10;                    contentAlignment = Alignment.Center&#10;                ) {&#10;                    Text(&#10;                        text = numero.toString(),&#10;                        color = MaterialTheme.colorScheme.onPrimary,&#10;                        fontWeight = FontWeight.Bold,&#10;                        fontSize = 16.sp&#10;                    )&#10;                }&#10;            }&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;            Text(&#10;                text = paso,&#10;                fontSize = 15.sp,&#10;                lineHeight = 22.sp,&#10;                modifier = Modifier.weight(1f),&#10;                color = MaterialTheme.colorScheme.onSurface&#10;            )&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/ui/screens/profile/DialogoSelectorTema.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/saborforaneo/ui/screens/profile/DialogoSelectorTema.kt" />
              <option name="originalContent" value="package com.example.saborforaneo.ui.screens.profile.dialogos&#10;&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.border&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Check&#10;import androidx.compose.material.icons.filled.Palette&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.saborforaneo.ui.screens.profile.TemaColor&#10;&#10;@Composable&#10;fun DialogoSelectorTema(&#10;    temaActual: TemaColor,&#10;    alCerrar: () -&gt; Unit,&#10;    alSeleccionar: (TemaColor) -&gt; Unit&#10;) {&#10;    var temaSeleccionado by remember { mutableStateOf(temaActual) }&#10;&#10;    AlertDialog(&#10;        onDismissRequest = alCerrar,&#10;        icon = {&#10;            Icon(&#10;                imageVector = Icons.Default.Palette,&#10;                contentDescription = null&#10;            )&#10;        },&#10;        title = { Text(&quot;Tema de Color&quot;) },&#10;        text = {&#10;            Column(&#10;                modifier = Modifier.fillMaxWidth()&#10;            ) {&#10;                Text(&#10;                    text = &quot;Elige tu color favorito para personalizar la aplicación:&quot;,&#10;                    fontSize = 14.sp,&#10;                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f),&#10;                    modifier = Modifier.padding(bottom = 16.dp)&#10;                )&#10;&#10;                TemaColor.values().forEach { tema -&gt;&#10;                    ItemTema(&#10;                        tema = tema,&#10;                        seleccionado = temaSeleccionado == tema,&#10;                        onClick = { temaSeleccionado = tema }&#10;                    )&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;                }&#10;            }&#10;        },&#10;        confirmButton = {&#10;            TextButton(&#10;                onClick = {&#10;                    alSeleccionar(temaSeleccionado)&#10;                    alCerrar()&#10;                }&#10;            ) {&#10;                Text(&quot;Aplicar&quot;)&#10;            }&#10;        },&#10;        dismissButton = {&#10;            TextButton(onClick = alCerrar) {&#10;                Text(&quot;Cancelar&quot;)&#10;            }&#10;        }&#10;    )&#10;}&#10;&#10;@Composable&#10;fun ItemTema(&#10;    tema: TemaColor,&#10;    seleccionado: Boolean,&#10;    onClick: () -&gt; Unit&#10;) {&#10;    Surface(&#10;        onClick = onClick,&#10;        modifier = Modifier.fillMaxWidth(),&#10;        shape = RoundedCornerShape(12.dp),&#10;        color = if (seleccionado)&#10;            Color(tema.colorPrimario).copy(alpha = 0.1f)&#10;        else&#10;            MaterialTheme.colorScheme.surfaceVariant,&#10;        border = if (seleccionado) {&#10;            androidx.compose.foundation.BorderStroke(2.dp, Color(tema.colorPrimario))&#10;        } else null&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            Box(&#10;                modifier = Modifier&#10;                    .size(40.dp)&#10;                    .clip(CircleShape)&#10;                    .background(Color(tema.colorPrimario)),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                if (seleccionado) {&#10;                    Icon(&#10;                        imageVector = Icons.Default.Check,&#10;                        contentDescription = null,&#10;                        tint = Color.White,&#10;                        modifier = Modifier.size(24.dp)&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;&#10;            Column(modifier = Modifier.weight(1f)) {&#10;                Text(&#10;                    text = tema.nombreMostrar,&#10;                    fontSize = 16.sp,&#10;                    fontWeight = FontWeight.Medium&#10;                )&#10;                Text(&#10;                    text = when(tema) {&#10;                        TemaColor.VERDE -&gt; &quot;El color clásico de SaborForáneo&quot;&#10;                        TemaColor.ROJO -&gt; &quot;Pasión por la cocina&quot;&#10;                        TemaColor.AZUL -&gt; &quot;Fresco y sereno&quot;&#10;                        TemaColor.NARANJA -&gt; &quot;Energético y cálido&quot;&#10;                        TemaColor.MORADO -&gt; &quot;Elegante y sofisticado&quot;&#10;                    },&#10;                    fontSize = 12.sp,&#10;                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;                )&#10;            }&#10;        }&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.saborforaneo.ui.screens.profile.dialogos&#10;&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.border&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.foundation.verticalScroll&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Check&#10;import androidx.compose.material.icons.filled.Palette&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.saborforaneo.ui.screens.profile.TemaColor&#10;&#10;@Composable&#10;fun DialogoSelectorTema(&#10;    temaActual: TemaColor,&#10;    alCerrar: () -&gt; Unit,&#10;    alSeleccionar: (TemaColor) -&gt; Unit&#10;) {&#10;    var temaSeleccionado by remember { mutableStateOf(temaActual) }&#10;&#10;    AlertDialog(&#10;        onDismissRequest = alCerrar,&#10;        icon = {&#10;            Icon(&#10;                imageVector = Icons.Default.Palette,&#10;                contentDescription = null&#10;            )&#10;        },&#10;        title = { Text(&quot;Tema de Color&quot;) },&#10;        text = {&#10;            val scrollState = rememberScrollState()&#10;            &#10;            Column(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .heightIn(max = 400.dp) // Altura máxima para el diálogo&#10;                    .verticalScroll(scrollState)&#10;            ) {&#10;                Text(&#10;                    text = &quot;Elige tu color favorito para personalizar la aplicación:&quot;,&#10;                    fontSize = 14.sp,&#10;                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f),&#10;                    modifier = Modifier.padding(bottom = 16.dp)&#10;                )&#10;&#10;                TemaColor.values().forEach { tema -&gt;&#10;                    ItemTema(&#10;                        tema = tema,&#10;                        seleccionado = temaSeleccionado == tema,&#10;                        onClick = { temaSeleccionado = tema }&#10;                    )&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;                }&#10;            }&#10;        },&#10;        confirmButton = {&#10;            TextButton(&#10;                onClick = {&#10;                    alSeleccionar(temaSeleccionado)&#10;                    alCerrar()&#10;                }&#10;            ) {&#10;                Text(&quot;Aplicar&quot;)&#10;            }&#10;        },&#10;        dismissButton = {&#10;            TextButton(onClick = alCerrar) {&#10;                Text(&quot;Cancelar&quot;)&#10;            }&#10;        }&#10;    )&#10;}&#10;&#10;@Composable&#10;fun ItemTema(&#10;    tema: TemaColor,&#10;    seleccionado: Boolean,&#10;    onClick: () -&gt; Unit&#10;) {&#10;    Surface(&#10;        onClick = onClick,&#10;        modifier = Modifier.fillMaxWidth(),&#10;        shape = RoundedCornerShape(12.dp),&#10;        color = if (seleccionado)&#10;            Color(tema.colorPrimario).copy(alpha = 0.1f)&#10;        else&#10;            MaterialTheme.colorScheme.surfaceVariant,&#10;        border = if (seleccionado) {&#10;            androidx.compose.foundation.BorderStroke(2.dp, Color(tema.colorPrimario))&#10;        } else null&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            Box(&#10;                modifier = Modifier&#10;                    .size(40.dp)&#10;                    .clip(CircleShape)&#10;                    .background(Color(tema.colorPrimario)),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                if (seleccionado) {&#10;                    Icon(&#10;                        imageVector = Icons.Default.Check,&#10;                        contentDescription = null,&#10;                        tint = Color.White,&#10;                        modifier = Modifier.size(24.dp)&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;&#10;            Column(modifier = Modifier.weight(1f)) {&#10;                Text(&#10;                    text = tema.nombreMostrar,&#10;                    fontSize = 16.sp,&#10;                    fontWeight = FontWeight.Medium&#10;                )&#10;                Text(&#10;                    text = when(tema) {&#10;                        TemaColor.VERDE -&gt; &quot;El color clásico de SaborForáneo&quot;&#10;                        TemaColor.ROJO -&gt; &quot;Pasión por la cocina&quot;&#10;                        TemaColor.AZUL -&gt; &quot;Fresco y sereno&quot;&#10;                        TemaColor.NARANJA -&gt; &quot;Energético y cálido&quot;&#10;                        TemaColor.MORADO -&gt; &quot;Elegante y sofisticado&quot;&#10;                    },&#10;                    fontSize = 12.sp,&#10;                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;                )&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>